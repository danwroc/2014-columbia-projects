YUI.add("hermes-template-follow",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){var r="",i,s;r+="\n	",s=n.unless.call(e,(i=e.relationship,i==null||i===!1?i:i.isMe),{hash:{},inverse:u.noop,fn:u.program(2,f,t),data:t});if(s||s===0)r+=s;return r+="\n",r}function f(e,t){var r="",i,s;r+='\n		<span class="relationship">\n			',s=n["if"].call(e,(i=e.relationship,i==null||i===!1?i:i.isIgnored),{hash:{},inverse:u.program(5,c,t),fn:u.program(3,l,t),data:t});if(s||s===0)r+=s;return r+="\n		</span>\n	",r}function l(e,t){return"\n				<!-- <button class='block is-blocked'>Unblock</button> -->\n			"}function c(e,t){var r="",i,s;r+="\n				",s=n["if"].call(e,(i=e.relationship,i==null||i===!1?i:i.isContact),{hash:{},inverse:u.program(8,p,t),fn:u.program(6,h,t),data:t});if(s||s===0)r+=s;return r+="\n				<!-- <button class='block'>Block</button> -->\n			",r}function h(e,t){return"\n					<button class='follow is-following ui-button ui-button-icon ui-button-transparent ui-button-dropdown'><span>Following</span></button>\n				"}function p(e,t){return"\n					<button class='follow ui-button ui-button-icon'><span>Follow</span></button>\n				"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this;s+="\n",o=n["if"].call(t,t.signedIn,{hash:{},inverse:u.noop,fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/follow",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-following-dropdown",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){return'\n			<input type="checkbox" checked="checked" id="friend-checkbox" />\n		'}function f(e,t){return'\n			<input type="checkbox" id="friend-checkbox" />\n		'}function l(e,t){return'\n			<input type="checkbox" checked="checked" id="family-checkbox" />\n		'}function c(e,t){return'\n			<input type="checkbox" id="family-checkbox" />\n		'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this;s+='<ul>\n	<li class="following-friend">\n		',o=n["if"].call(t,t.isFriend,{hash:{},inverse:u.program(3,f,i),fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;s+='\n		<label for="friend-checkbox">Friend</label>\n	</li>\n	<li class="following-family">\n		',o=n["if"].call(t,t.isFamily,{hash:{},inverse:u.program(7,c,i),fn:u.program(5,l,i),data:i});if(o||o===0)s+=o;return s+='\n		<label for="family-checkbox">Family</label>\n	</li>\n	<li class="divider"></li>\n	<li class="following-unfollow">\n		<a href="#"><i class="ui-icon-tiny-unfollow"></i> Unfollow</a>\n	</li>\n</ul>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/following-dropdown",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("follow-view",function(e){e.namespace("Views")[this.name]=e.Base.create("follow-view",e.FlickrView,[],{initializer:function(e){return this.nsid=e.nsid,this.realFullscreen=!!e.realFullscreen,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("person-relationship-models",e.nsid).then(function(t){e.set("relationship",t)})},buildContainer:function(){var e=this.get("relationship"),t;return t=this.templates("follow")({relationship:e.toJSON(),signedIn:this.appContext.getViewer().signedIn}),this.setContainerHTML(t),this},handleRelationshipClick:function(t){t.preventDefault();var n=this.get("relationship").getValue("isContact"),r=t.currentTarget;n===!1?(this.get("relationship").registry.toggleFollowing(this.nsid),this.toggleFollowingButton(r,this.get("relationship").getValue("isContact")),this.get("relationship").registry.remoteUpdate(this.nsid).then(null,function(e){this.get("relationship").setValue("isContact",n),this.toggleFollowingButton(t.target.ancestor("button"),n),this.appContext.error(e)}.bind(this)),e.rapidTracker.beacon(this.name,"photoAttributionFollowButtonClick")):(this.relationshipDropDownDialog.toggle(),e.rapidTracker.beacon(this.name,"photoAttributionFollowMenuClick"))},handleFriendChange:function(e){this.get("relationship").registry.toggleFriend(this.nsid),this.get("relationship").registry.remoteUpdate(this.nsid).then(null,function(t){this.get("relationship").registry.toggleFriend(this.nsid),e.target.set("checked",!e.target.get("checked")),this.onError("There was a problem setting your friend relationship."),this.appContext.error(t)}.bind(this))},handleFamilyChange:function(e){this.get("relationship").registry.toggleFamily(this.nsid),this.get("relationship").registry.remoteUpdate(this.nsid).then(null,function(t){this.get("relationship").registry.toggleFamily(this.nsid),e.target.set("checked",!e.target.get("checked")),this.onError("There was a problem setting your family relationship."),this.appContext.error(t)}.bind(this))},handleUnfollowClick:function(t){t.preventDefault(),this.get("relationship").registry.toggleFollowing(this.nsid),this.relationshipDropDownDialog.toggle(function(){this.toggleFollowingButton(t.target.ancestor(".relationship").one("button"),this.get("relationship").getValue("isContact"))}.bind(this)),this.get("relationship").registry.remoteUpdate(this.nsid).then(null,function(e){this.get("relationship").setValue("isContact",!0),this.toggleFollowingButton(t.target.ancestor("button"),!0),this.appContext.error(e)}.bind(this)),e.rapidTracker.beacon(this.name,"photoAttributionUnfollowButtonClick")},toggleFollowingButton:function(e,t){t?(e.setContent("<span>Following</span>"),e.addClass("follow-anim").addClass("is-following"),setTimeout(function(){e.removeClass("follow-anim")},500),e.addClass("ui-button-dropdown")):(e.addClass("unfollow-anim").removeClass("is-following"),setTimeout(function(){e.removeClass("unfollow-anim")},500),e.one("span").setContent("Follow"),e.removeClass("ui-button-dropdown"))},onError:function(t){var n=e.Views.dialog.getInstance("dialog-alert",{content:"Error! "+t,attrs:{level:"warning"},parent:this});n.show()},setupDropdown:function(){var t=this,n=t.get("container"),r,i,s=n.one(".relationship button");i=this.templates("following-dropdown")({isFriend:this.get("relationship").getValue("isFriend"),isFamily:this.get("relationship").getValue("isFamily")}),this.relationshipDropDownDialog=e.Views.dialog.getNewInstance("dialog-tooltip",{content:i,anchorTo:n.one(".relationship"),positioning:!1,parent:this}),this.registerEventHandler(this.relationshipDropDownDialog.on("hide",function(e){s.removeClass("is-open")})),this.registerEventHandler(this.relationshipDropDownDialog.on("show",function(e){s.addClass("is-open")})),this.relationshipDropDownDialog.render(),r=this.relationshipDropDownDialog.get("container"),r.detach("click"),this.registerEventHandler(r.one(".following-unfollow").on("click",this.handleUnfollowClick,this)),this.registerEventHandler(r.one(".following-friend input").on("change",this.handleFriendChange,this)),this.registerEventHandler(r.one(".following-family input").on("change",this.handleFamilyChange,this))},activate:function(){var e=this,t=e.get("container");return t&&t.one("button")&&this.registerEventHandler(t.one("button").on("click",e.handleRelationshipClick,e)),this.get("relationship").getValue("isMe")||this.setupDropdown(),e}})},"@VERSION@",{requires:["flickr-view","hermes-template-follow","follow-css","promise","hermes-template-following-dropdown"],optional:["person-models","person-relationship-models"]});
YUI.add("attribution-view",function(e){e.namespace("Views")[this.name]=e.Base.create("attribution-view",e.FlickrView,[],{subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1}},initializer:function(e){return this.nsid=e.nsid,this.realFullscreen=!!e.realFullscreen,this},loadState:function(){var t=this;return e.batch(t.appContext.getModel("person-models",t.nsid)).then(function(e){t.set("owner",e[0])})},buildContainer:function(){var e=this.get("owner"),t=e.getValue("pathAlias")||e.getValue("nsid"),n,r;return r=e.getValue("buddyicon").large?e.getValue("buddyicon").large:e.getValue("buddyicon")["default"],n=this.templates("attribution")({pathAlias:t,buddyicon:r,displayname:e.getValue("displayname"),follow:this.subviews["follow-view"].get("container"),realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode()}),this.setContainerHTML(n),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-attribution","photo-attribution-css","promise","follow-view"],optional:["person-models"]});
YUI.add("hermes-template-photo-title-desc",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n<div class="\n	title-desc-block \n	',i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n.unless.call(e,e.enableCollapsableTitleAndDescription,{hash:{},inverse:a.noop,fn:a.program(4,h,t),data:t});if(i||i===0)r+=i;r+='\n">\n    ',i=n.unless.call(e,e.noTitleToDisplay,{hash:{},inverse:a.noop,fn:a.program(6,p,t),data:t});if(i||i===0)r+=i;r+="\n\n	",i=n.unless.call(e,e.noDescToDisplay,{hash:{},inverse:a.noop,fn:a.program(11,m,t),data:t});if(i||i===0)r+=i;r+="\n\n</div>\n",i=n["if"].call(e,e.enableCollapsableTitleAndDescription,{hash:{},inverse:a.noop,fn:a.program(14,y,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){return"editable"}function h(e,t){return"showFull"}function p(e,t){var r="",i,s;r+='\n	    <span class="',i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+=" meta-field photo-title ",s=n["if"].call(e,(i=e.empty,i==null||i===!1?i:i.title),{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(s||s===0)r+=s;r+='">\n	        ',s=n["if"].call(e,e.title,{hash:{},inverse:a.noop,fn:a.program(9,v,t),data:t});if(s||s===0)r+=s;return r+='\n	    </span>\n\n	    <textarea class="meta-field edit-meta-field edit-photo-title" wrap="on"></textarea>\n	    <textarea class="meta-field edit-meta-field false-textarea false-edit-photo-title" wrap="on"></textarea>\n    ',r}function d(e,t){return"placeholder-text"}function v(e,t){var r="",i;return r+="\n	            ",(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===o?i.apply(e):i),r+=u(i)+"\n	        ",r}function m(e,t){var r="",i,s;r+='\n	    <span class="',i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.noop,fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;r+=" meta-field photo-desc ",s=n["if"].call(e,(i=e.empty,i==null||i===!1?i:i.desc),{hash:{},inverse:a.noop,fn:a.program(7,d,t),data:t});if(s||s===0)r+=s;r+='">\n	        ',s=n["if"].call(e,e.description,{hash:{},inverse:a.noop,fn:a.program(12,g,t),data:t});if(s||s===0)r+=s;return r+='\n	    </span>\n\n	    <textarea class="meta-field edit-meta-field edit-photo-desc" wrap="on"></textarea>\n	    <textarea class="meta-field edit-meta-field false-textarea false-edit-photo-desc" wrap="on"></textarea>\n    ',r}function g(e,t){var r="",i,s;return r+="\n	            ",s={hash:{},data:t},r+=u((i=n.photoDescription||e.photoDescription,i?i.call(e,e.description,s):f.call(e,"photoDescription",e.description,s)))+"\n	        ",r}function y(e,t){var r="",i,s;r+="\n	",s=n.unless.call(e,(i=e.empty,i==null||i===!1?i:i.desc),{hash:{},inverse:a.noop,fn:a.program(15,b,t),data:t});if(s||s===0)r+=s;return r+="\n",r}function b(e,t){return'\n		<span class="title-desc-more-button">more</span>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o="function",u=this.escapeExpression,a=this,f=n.helperMissing;return s=n.unless.call(t,t.noContentToDisplay,{hash:{},inverse:a.noop,fn:a.program(1,l,i),data:i}),s||s===0?s:""}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-title-desc",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-title-desc-view",function(e){e.namespace("Views")[this.name]=e.Base.create("photo-title-desc-view",e.FlickrView,[],{initializer:function(e){return this.photoId=e.photoId,this.full=e.full||!1,this.get("container").html===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){var e=this.get("photo"),t=e.getValue("title"),n=e.getValue("description"),r={title:!1,desc:!1},i=!1,s=!1,o=!1,u=e.getValue("isOwner"),a;if(t.trim()===""||t.toUpperCase()==="<BR>")r.title=!0;return r.title&&u&&(t="add title"),t=this.removeLinkFromHash(t),n.trim()===""&&(r.desc=!0),r.desc&&u&&(n="add description"),r.desc&&r.title&&!u?i=!0:r.desc&&!u?o=!0:r.title&&!u&&(s=!0),a=this.templates("photo-title-desc")({title:t,description:n,empty:r,isOwner:u,noContentToDisplay:i,noTitleToDisplay:s,noDescToDisplay:o,enableCollapsableTitleAndDescription:this.appContext.flipper.isFlipped("enable-collapsable-title-and-description")}),this.setContainerHTML(a),this},showFull:function(e){this.full?e.target.getDOMNode().tagName.toUpperCase()!=="A"&&(e.preventDefault(),this.toggleTitleDesc({show:!1,showButton:!0})):this.toggleTitleDesc({show:!1,showButton:!0})},addLinkToHash:function(e){var t=/\s#[^#\s]+/gi,n;return n=e.replace(t,function(t,n,r){return n>0&&e.slice(n-1,1)==="&"?t:' <a href="/photos/tags/'+t.slice(2)+'">'+t.slice(1)+"</a>"}),n},removeLinkFromHash:function(e){var t=/<[^>]*>(.*?\s#[^#\s]+?.*?)<[\s]*\/[\s]*[^>]*>/gi,n;return n=e.replace(t,function(e,t,n){return t}),n},filterDuplicateTags:function(e,t){var n=/#[^#\s]+/gi,r,i=[];return t&&e&&(r=(e.match(n)||[]).map(function(e){return e.slice(1)}),i=t.filter(function(e){return r.indexOf(e.tagValue)===-1})),i},wrapDescription:function(e){var t=e.split("\n"),n=this;return t.length===1&&t[0]===""?"":t.map(function(e){return"<p>"+n.addLinkToHash(n.removeLinkFromHash(e))+"</p>\n"}).join("")},unwrapDescription:function(e){var t=e.split("</p>");return t.map(function(e){return e.replace(/(<p){1,1}([\s]+id="yui_[\d_]+"[.]*){0,1}>/g,"")}).filter(function(e){return e.trim()!==""}).join("").replace(/^(\n)+(.*)/g,"$2")},doneEditingAttr:function(t){var n=this.get("container"),r=this,i=this.get("photo"),s=n.one(".photo-title"),o=n.one(".photo-desc"),u=n.one(".edit-photo-title"),a=n.one(".edit-photo-desc"),f,l=u.get("value"),c=a.get("value"),h,p;n.removeClass("editing"),e.one("body").one(".editing-shim")&&e.one("body").one(".editing-shim").remove(),s.set("text",l),o.set("text",c),s.set("contenteditable",null),o.set("contenteditable",null),s.addClass("disabled"),o.addClass("disabled"),p=c.toString(),p=p.replace(/(#[^#\s]+)/gi,function(e,t,n,r){return n>0&&p.slice(n-1,n)==="&"?"":e}),h=(p.match(/(#[^#\s]+)/gi)||[]).map(function(e){return e.slice(1)}),i.setValue("title",l),i.setValue("description",c),h.length>0&&this.appContext.getModelRegistry("photo-tags-models").then(function(t){var n=[];return h.length>0&&n.push(t.remoteCreate({photoId:r.photoId,tags:h.join(",")})),e.batch.apply(r,n)}).then(function(t){t[0].length>0&&e.fire("flickr:photo-page--new-tags-added",t[0])},function(e){}),l===""||l.toUpperCase()==="<BR>"?(s.setHTML("add title"),s.addClass("placeholder-text")):s.removeClass("placeholder-text"),c===""||c.toUpperCase()==="<BR>"?(o.setHTML("add description"),o.addClass("placeholder-text")):o.removeClass("placeholder-text"),s.removeClass("show-editable"),u.removeClass("show-editable"),o.removeClass("show-editable"),a.removeClass("show-editable"),f=i.remoteUpdate(),f.then(function(){var t=i.getValue("title"),n=i.getValue("description");s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),t===""?(s.setHTML("add title"),s.addClass("placeholder-text")):(s.set("text",t),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;")))),n===""?(o.setHTML("add description"),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(n).toString()),this.appContext.flipper.isFlipped("enable-collapsable-title-and-description")&&r.toggleTitleDesc({show:!1,noEffect:!0})},function(t){if(t.code!==3){var n=e.Views.dialog.getInstance("dialog-alert",{content:"Error! We couldn't change the description at this time.",attrs:{level:"warning"},appContext:r.appContext});n.show()}s.set("contenteditable","true"),o.set("contenteditable","true"),s.removeClass("disabled"),o.removeClass("disabled"),i.getValue("title")===""?(s.setHTML("add title"),s.addClass("placeholder-text")):(s.set("text",i.getValue("title")),s.setHTML(r.addLinkToHash(s.get("text").replace(/</g,"&lt;").replace(/>/g,"&gt;")))),i.getValue("description")===""?(o.setHTML("add description"),o.addClass("placeholder-text")):o.setHTML(e.Handlebars.helpers.photoDescription(i.getValue("description")).toString()),r.toggleTitleDesc({show:!1,noEffect:!0})})},startEditingAttr:function(t){var n=this,r=this.get("container"),i=this.get("photo"),s=i.getValue("title"),o=i.getValue("description"),u=r.one(".photo-title"),a=r.one(".photo-desc"),f=r.one(".edit-photo-title"),l=r.one(".edit-photo-desc"),c=r.one(".false-edit-photo-title"),h=r.one(".false-edit-photo-desc"),p,d;if(u.hasClass("disabled")||a.hasClass("disabled"))return;r.addClass("editing"),e.one("body").append('<div class="editing-shim" style="top:0;width:100%;height:100%;position:absolute;z-index:50;">&nbsp;</div>').setStyle("display","block"),this.registerEventHandler(e.one("body").one(".editing-shim").on("click",function(){n.doneEditingAttr()},this)),this.registerEventHandler(e.one("body").one(".editing-shim").on("focus",function(){n.doneEditingAttr()},this)),p=s,d=o,u.hasClass("placeholder-text")&&(p="",f.set("placeholder","add title")),a.hasClass("placeholder-text")&&(d="",l.set("placeholder","add description")),f.set("value",this.unwrapDescription(p)),c.set("value",this.unwrapDescription(p)),l.set("value",this.unwrapDescription(d)),h.set("value",this.unwrapDescription
(d)),f.setStyle("height",c._node.scrollHeight+"px"),f.setStyle("minHeight",c._node.scrollHeight+"px"),f.addClass("show-editable"),u.addClass("show-editable"),l.setStyle("height",h._node.scrollHeight+"px"),l.setStyle("minHeight",h._node.scrollHeight+"px"),l.addClass("show-editable"),a.addClass("show-editable"),r.one(t).focus(),r.one(t).getDOMNode().setSelectionRange(r.one(t).getDOMNode().value.length,r.one(t).getDOMNode().value.length),this.toggleTitleDesc({showButton:!1,show:!0,noEffect:!0})},toggleTitleDesc:function(e){var t=this.get("container"),n;this.full=e.show||!this.full,this.full?(e.noEffect||this.fire("flickr:expand-sidebar"),t.one(".title-desc-block").addClass("showFull")):(t.one(".title-desc-block").removeClass("showFull"),e.noEffect||this.fire("flickr:collapse-sidebar")),t.one(".title-desc-more-button")&&(this.toggleTitleDescTruncationButton(),n=typeof e.showButton!="undefined"?e.showButton:this.titleDescHasOverflow(),this.showMoreButton(n))},toggleTitleDescTruncationButton:function(){var e=this.get("container");this.full?e.one(".title-desc-more-button").setHTML("less"):e.one(".title-desc-more-button").setHTML("more")},showMoreButton:function(e){var t=this.get("container"),n=t.one(".title-desc-more-button");e?n.addClass("title-desc-has-overflow"):n.removeClass("title-desc-has-overflow")},titleDescHasOverflow:function(){var e=this.get("container"),t=e.one(".title-desc-block"),n=t.getDOMNode(),r=t&&t.getComputedStyle?parseInt((t.getComputedStyle("maxHeight")||n.clientHeight+"").replace("px",""),10):n.clientHeight;return n.clientHeight<n.scrollHeight&&n.scrollHeight>r},activate:function(){var e=this.get("container"),t=this.get("photo"),n=e.one(".title-desc-more-button"),r=this;return e&&(e.one(".photo-title")&&e.one(".photo-title").setHTML(this.addLinkToHash(e.one(".photo-title").getHTML())),n&&r.showMoreButton(r.titleDescHasOverflow())),n&&r.registerEventHandler(n.on("click",r.showFull,r)),t&&t.getValue("isOwner")&&[{field:".photo-title",editField:".edit-photo-title",editFalseField:".false-edit-photo-title"},{field:".photo-desc",editField:".edit-photo-desc",editFalseField:".false-edit-photo-desc"}].forEach(function(t){if(!r.appContext.flipper.isFlipped("tags-charm")||t.field!==".photo-tags")r.registerEventHandler(e.one(t.field).on("click",function(){r.startEditingAttr(t.editField)},r)),r.registerEventHandler(e.one(t.editField).on("input",function(n){e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px"),e.one(t.editField).setStyle("minHeight",e.one(t.editFalseField)._node.scrollHeight+"px")})),r.registerEventHandler(e.one(t.editField).on("keydown",function(n){n.charCode===13&&!n.altKey&&!n.shiftKey?(n.preventDefault(),r.doneEditingAttr(),e.one(t.editField).blur()):(e.one(t.editFalseField).set("value",e.one(t.editField).get("value")),e.one(t.editField).setStyle("height",e.one(t.editFalseField)._node.scrollHeight+"px"),e.one(t.editField).setStyle("minHeight",e.one(t.editFalseField)._node.scrollHeight+20+"px"))}))}),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-photo-title-desc","photo-title-desc-css","array-extras","handlebars-helpers"],optional:["photo-models","photo-tags-models"]});
YUI.add("hermes-template-photo-stats",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return'\n	<li class="view-count">\n		<span class="view-count-label">&nbsp;</li>\n	</li>\n'}function h(e,t){var r="",i,s,o;r+='\n	<li class="view-count">\n		<span class="stat-icon ui-icon-tiny-view-count">&nbsp;</span>\n		<span class="view-count-label">',o={hash:{},data:t},r+=a((i=n.friendlyNumber||e.friendlyNumber,i?i.call(e,(i=e.stats,i==null||i===!1?i:i.viewCount),o):l.call(e,"friendlyNumber",(i=e.stats,i==null||i===!1?i:i.viewCount),o)))+'</span>\n	</li>\n	<li class="date-taken">\n		<span class="stat-icon ui-icon-tiny-date">&nbsp;</span>\n		<span class="date-taken-label">',o={hash:{},data:t},r+=a((i=n.friendlyDate||e.friendlyDate,i?i.call(e,(i=e.stats,i==null||i===!1?i:i.dateTaken),(i=e.stats,i==null||i===!1?i:i.takenGranularity),o):l.call(e,"friendlyDate",(i=e.stats,i==null||i===!1?i:i.dateTaken),(i=e.stats,i==null||i===!1?i:i.takenGranularity),o)))+"</span>\n	</li>\n	",s=n["if"].call(e,e.isOwner,{hash:{},inverse:f.noop,fn:f.program(4,p,t),data:t});if(s||s===0)r+=s;return r+="\n",r}function p(e,t){var r="",i,s,o;r+='\n	<li class="privacy-control">\n		<div class="ui-dropdown ui-dropdown-alignright ui-dropdown-noarrow ui-dropdown-closed">\n			<span data-action="toggle"><i class="ui-icon-tiny-privacy',(i=n.privacySelected)?i=i.call(e,{hash:{},data:t}):(i=e.privacySelected,i=typeof i===u?i.apply(e):i),r+=a(i)+'"></i></span>\n			<span class="ui-dialog-arrow"></span>\n			<ul>\n				',o={hash:{},inverse:f.noop,fn:f.program(5,d,t),data:t},s=(i=n.eachConfigVal||e.eachConfigVal,i?i.call(e,"privacy",o):l.call(e,"eachConfigVal","privacy",o));if(s||s===0)r+=s;return r+="\n			</ul>\n		</div>\n	</li>\n	",r}function d(e,t){var r="",i;return r+='\n				<li data-action="set" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===u?i.apply(e):i),r+=a(i)+'" data-text="',(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===u?i.apply(e):i),r+=a(i)+'">',(i=n.text)?i=i.call(e,{hash:{},data:t}):(i=e.text,i=typeof i===u?i.apply(e):i),r+=a(i)+"</li>\n				",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=this,l=n.helperMissing;s+='<ul class="photo-stats clear-float">\n',o=n["if"].call(t,t.loadingView,{hash:{},inverse:f.program(3,h,i),fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;return s+="\n</ul>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-stats",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dropdown",function(e){"use strict";var t,n;t={css:{closed:"ui-dropdown-closed",shim:"ui-dropdown-shim",label:'span[data-action="toggle"]',items:"[data-value]",itemSelected:"ui-dropdown-item-selected"}},e.namespace("Views").Dropdown=n=e.Base.create("Dropdown",e.FlickrView,[],{initializer:function(e){if(e.activate===!1)return;this.activate()},activate:function(){var n=this,r,i,s,o=this.get("container");this.close(),this._items={},s=this.get("selected")+"",o.all(t.css.items).each(function(e){var t=e.getData();n._items[t.value]={text:t.text||'no data-text for "'+t.value+'"',node:e};if(!r||t.value===s)r=e}),r||(r=e.Node.create("<div/>"),this._items._none_={text:"[!empty ui-dropdown list!]",node:e.Node.create("<div/>")}),this.labelEl=o.one(t.css.label),this.labelEl||(this.labelEl=e.Node.create('<span class="truncate" data-action="toggle" />'),o.insert(this.labelEl,0)),i=r.getData(),this.select(i.value||"_none_",{data:r.getData(),value:r.value}),r=null;if(this.get("disabled"))return this.disable();this.attachEvents({":toggle":this.toggle.bind(this),":set":function(e,t){e.halt();if(t.value===n.get("selected"))return n.close();n.select(t.value,{data:t,value:t.value})}})},select:function(e,n){if(!this._items[e])return;this.set("selected",e),this.close(),n={data:n?n.data:null,value:e,listItemEl:this._items[e].node,text:this._items[e].text},this.fire("selected",n),this.update(e,n,t)},update:function(e,t,n){this.labelEl.set("textContent",t.text||"[!empty data-text!]"),t.listItemEl.siblings(n.css.items).removeClass(n.css.itemSelected),t.listItemEl.addClass(n.css.itemSelected)},toggle:function(e){e&&e.halt(),this._open?this.close(e):this.open(e)},open:function(e){this._open=!0,this._shimUp(),this.get("container").removeClass(t.css.closed),(!e||!e.silent)&&this.fire("open",e)},close:function(e){e&&e.halt(),this._open=!1,this._shimUp(!1),this.get("container").addClass(t.css.closed)},_shimUp:function(n){if(n===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div/>"),this._shim.addClass(t.css.shim),this._shim.on("click",this.close.bind(this)),this.get("container").appendChild(this._shim)},disable:function(){this.set("disabled",!0);var e=this.get("container");this.close(),e.addClass(t.css.disabled),e.detach()},destructor:function(){this._shimUp(!1),this.labelEl=null,this._items=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:null},disabled:{value:!1}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("photo-stats-view",function(e){e.namespace("Views")[this.name]=e.Base.create("photo-stats-view",e.FlickrView,[],{initializer:function(e){this.photoId=e.photoId,this.nsid=e.nsid;if(this.get("container").get("innerHTML")===""){var t=this.templates("photo-stats")({stats:{},privacy:{},privacySelected:"",isOwner:!1,loadingView:!0});this.setContainerHTML(t)}return this},loadState:function(){var t=this,n;return n=new e.FlickrPromise({stats:this.appContext.getModel("photo-stats-models",this.photoId),privacy:this.appContext.getModel("photo-privacy-models",this.photoId),relationship:this.appContext.getModel("person-relationship-models",this.nsid)}),n.then(function(e){t.set("stats",e.stats),t.set("privacy",e.privacy),t.set("relationship",e.relationship)},this.appContext.warn.bind(this))},buildContainer:function(){var e,t;return e={stats:this.get("stats")?this.get("stats").toJSON():{},privacy:this.get("privacy")?this.get("privacy").toJSON():{},privacySelected:this.get("privacy")?this.mapPrivacy(this.get("privacy").toJSON()):"",isOwner:this.get("relationship")?this.get("relationship").getValue("isMe"):!1},t=this.templates("photo-stats")(e),this.setContainerHTML(t),this},activate:function(){var t=this,n=this.get("privacy");return n&&this.registerEventHandler(n.on("valuesChanged",function(e){var r=t.get("container").one(".privacy-control i"),i=t.mapPrivacy(n.toJSON());r.hasClass("ui-icon-tiny-privacy"+i.toLowerCase())||t.privacyDd.select(i)})),this.privacyDd=new e.Views.Dropdown({appContext:this.appContext,container:this.get("container").one(".privacy-control .ui-dropdown"),activate:!1,selected:this.mapPrivacy(this.get("privacy").toJSON()),disabled:!this.get("relationship").getValue("isMe")}),this.privacyDd.update=function(e,t,n){var r=this.labelEl.one("i");if(!r)return;r.getDOMNode().className="ui-icon-tiny-privacy"+e.toLowerCase(),t.listItemEl.siblings(n.css.items).removeClass(n.css.itemSelected),t.listItemEl.addClass(n.css.itemSelected)},this.privacyDd.activate(),this.privacyDd.on("open",function(n){e.rapidTracker.beacon(t.name,"privacySettingMenuClick")}),this.privacyDd.on("selected",function(e){t.setPrivacy(e.value)}),this.on("destroy",function(){t.privacyDd.destroy()}),this},setPrivacy:function(e){var t=this.get("privacy"),n=this.mapPrivacy(e),r;Object.keys(n).forEach(function(e){t.setValue(e,n[e])}),t.remoteUpdate().then(null,function(e){Object.keys(n).forEach(function(e){t.revertValue(e)}),r=this.mapPrivacy(t.toJSON()),self.onError("There was a problem changing your photo's privacy"),self.appContext.error(e)}.bind(self))},mapPrivacy:function(e){var t,n,r,i,s;t=[["public",["isPublic"]],["friendsAndFamily",["isVisibleByFriends","isVisibleByFamily"]],["friends",["isVisibleByFriends"]],["family",["isVisibleByFamily"]],["private",[]]];if(typeof e=="object"){for(n=0,r=t.length;n<r;n++){i=t[n];if(!i[1].length||i[1].every(function(t){return!!e[t]}))return i[0]}return null}s={};for(n=0,r=t.length;n<r;n++)i=t[n],i[1].forEach(function(t){s[t]=i[0]===e?!0:s[t]||!1});return s}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-stats","promise","photo-stats-css"],optional:["photo-stats-models","dropdown"]});
YUI.add("hermes-template-photo-sidebar-actions",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r,i;return i={hash:{},data:t},l((r=n.formatNumber||e.formatNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.commentCount),i):f.call(e,"formatNumber",(r=e.photo,r==null||r===!1?r:r.commentCount),i)))}function p(e,t){var r,i;return i={hash:{},data:t},l((r=n.friendlyNumber||e.friendlyNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.commentCount),i):f.call(e,"friendlyNumber",(r=e.photo,r==null||r===!1?r:r.commentCount),i)))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["fave-view"],a):f.call(t,"outlet",t["fave-view"],a)))+'\n<div>\n	<a title="Comment" class="button comment" href="#">\n		<span class="ui-icon-comments">&nbsp;</span>\n		<span class="button-comment-count">',u=n["if"].call(t,t.realFullscreen,{hash:{},inverse:c.program(3,p,i),fn:c.program(1,h,i),data:i});if(u||u===0)s+=u;return s+='</span>\n	</a>\n</div>\n<div>\n	<a title="Share this photo" class="button share ui-util-dialog-anchor">\n		<i class="ui-icon-share"></i>\n	</a>\n</div>\n\n',a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["more-menu-view"],a):f.call(t,"outlet",t["more-menu-view"],a))),s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-sidebar-actions",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("charmtabs",function(e){"use strict";var t,n;t={css:{charmItems:"li[data-tab]",contentItems:"div[data-tab]",contentItem:'div[data-tab="{{tab}}"]',charmSelected:"ui-charmtabs-charmitem-selected",contentSelected:"ui-charmtabs-contentitem-selected"}},e.namespace("Views").CharmTabs=n=e.Base.create("CharmTabs",e.FlickrView,[],{initializer:function(e){this._tabs={},this.charmIndicator=null;if(e.activate===!1)return;this.activate()},activate:function(){var e=this,n,r,i=this.get("container");this.charmIndicator=i.one(".photo-charm-indicator"),r=this.get("selected")+"",i.all(t.css.charmItems).each(function(s){var o=s.getData();e._tabs[o.tab]={tabName:o.tab,contentEl:i.one(t.css.contentItem.replace("{{tab}}",o.tab)),charmEl:s,charmPositionLeft:null};if(!n||o.tab===r)n=o.tab});if(!n)throw new Error('[CharmTabs] No "'+t.css.charmItems+'" elements found.');this.refreshLayout(n),this.attachEvents({":switch":function(t,n){t.halt(),e.select(n.tab)}})},refreshLayout:function(e){var t=this;Object.keys(this._tabs).forEach(function(e){t._tabs[e].charmPositionLeft=t._tabs[e].charmEl.get("offsetLeft")}),this.select(e||this.get("selected"),!0)},select:function(e,n){if(!this.getTab(e))return;if(e===this.get("selected")&&!n)return;this.set("selected",e),this.fire("selected",this._tabs[e]),this.update(e,t)},getTab:function(e){return e||(e=this.get("selected")),this._tabs[e]||null},update:function(e,t){var n=this.getTab(e);this.charmIndicator.setStyles({left:n.charmPositionLeft+24+"px",opacity:1}),n.charmEl.siblings(t.css.charmItems).removeClass(t.css.charmSelected),n.charmEl.addClass(t.css.charmSelected),n.contentEl.siblings(t.css.contentItems).removeClass(t.css.contentSelected),n.contentEl.addClass(t.css.contentSelected)},destructor:function(){this.charmIndicator=null,this._tabs=null,this.set("selected",null),this.detachAll()}},{ATTRS:{selected:{value:null}}})},"@VERSION@",{requires:["flickr-view","flickrui-css"]});
YUI.add("flickr-contacts-getListfetcher",function(e){"use strict";function t(t,n){var r=t[0],i=t[1];return r.contacts&&r.contacts.contact&&r.contacts.contact.forEach(function(t){i.exists(t.nsid)||i.add(e.APIHelper.response.parsePerson(t))}),r}function n(t,n){var r=this;return t.extras=(t.extras||"")+", icon_urls, paid_products",e.batch(n.callAPI("flickr.contacts.getList",t),n.getModelRegistry("person-models")).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-contacts-getList-fetcher] failed getting or processing API response:",e),e})}e.namespace("ListFetchers")["flickr-contacts-getList"]={run:n,_processResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-models"]});
YUI.add("contact-search-box",function(e){var t=function(e){this.options=e,this.options.elValue=this.options.elValue||"value",this.options.hideInitially||[],this._contacts=null,this.queryEl=this.options.el,this.queryElEvent,this.listEl=null,this.init()};t.prototype={init:function(){var t=this;this.queryElEvent=this.queryEl.on("keyup",this.search.bind(this)),this.wrapperEl=e.Node.create("<div/>"),this.wrapperEl.addClass("c-contact-search-autocomplete"),this.listEl=e.Node.create("<ul/>"),this.listEl.addClass("contact-list"),this.wrapperEl.appendChild(this.listEl),this.queryEl.ancestor().insertBefore(this.wrapperEl,this.queryEl),this.wrapperEl.appendChild(this.queryEl),this.options.clickContact=this.options.clickContact||function(e){var n=e.target.ancestor("[data-nsid]",!0).getData("nsid");t.select(n)},this.listEl.delegate("click",this.options.clickContact,"li")},getContact:function(e){var t=0,n=this._contacts,r=n.length;for(;t<r;t++)if(n[t].nsid===e&&!n[t].hide)return n[t]},hideFromSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!0,!0})},showInSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!1,!0})},load:function(e){var t={},n=this,r,i;if(this._busy)return;return this._busy=!0,t.can_tag=this.options.canTag||0,i=this.options.appContext.getViewer().nsid,r=this.options.appContext.getModel("contacts-models",i),r.then(function(r){return t.page=1,t.per_page=1e3,r.getValue("contacts").getPage(t).then(function(t){n._busy=!1;try{n._contacts=t.contacts.contact||[]}catch(r){n._contacts=[]}n._contacts.forEach(function(e){e.realname||(e.realname=e.username),e.iconfarm?(e.buddyicon="//farm"+e.iconfarm+".static.flickr.com",e.buddyicon+="/"+e.iconserver+"/buddyicons",e.buddyicon+="/"+e.nsid+".jpg"):e.buddyicon="//l.yimg.com/g/images/buddyicon06.png"});if(n.options.me){var i=n.options.me.toJSON();i.buddyicon=i.buddyicon["default"]||"//l.yimg.com/g/images/buddyicon06.png",i.me=!0,n._contacts.push(i)}n._contacts.forEach(function(e){n.options.hideInitially.indexOf(e.nsid)>-1&&(e.hide=!0)}),e()},function(){n._busy=!1,n.options.onError()})},function(){n._busy=!1,n.options.onError()})},destructor:function(){this.queryElEvent&&this.queryElEvent.detach&&this.queryElEvent.detach()},hide:function(e){e&&e.halt();if(!this._visible)return;this._visible=!1,this._shimUp(!1),this.listEl.setStyle("display","none"),this.options.onHide&&this.options.onHide()},show:function(){if(this._visible)return;this._visible=!0,this._shimUp(),this.listEl.setStyle("display","block");var t={width:e.config.win.innerWidth,height:e.config.win.innerHeight},n=this.options.el.getDOMNode().getBoundingClientRect(),r=this.listEl.getDOMNode().getBoundingClientRect(),i=!this._contacts,s=i&&this.options.upInitially;s||n.top>0&&n.top+r.height+25>t.height?(this.listEl.setStyle("top","auto"),this.listEl.setStyle("bottom","25px"),this.options.onOrientationChange&&this.options.onOrientationChange(!0)):(this.listEl.setStyle("top",null),this.listEl.setStyle("bottom",null),this.options.onOrientationChange&&this.options.onOrientationChange(!1)),this.options.onShow()},_shimUp:function(t){if(t===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div/>"),this._shim.addClass(this.options.shim),this._shim.on("click",this.hide.bind(this)),this.wrapperEl.appendChild(this._shim)},select:function(e){typeof e=="string"&&(e=this.getContact(e),this.queryEl.set("value",e.realname)),this.selected=e,this.options.onSelect(e),this.hide()},search:function(){var e=this.queryEl.get(this.options.elValue),t=e.replace(/[^A-Z0-9]+/gi,"|").replace(/^\||\|$/g,""),n=new RegExp(t,"i");this.selected=null;if(this._contacts&&this.options.me&&e==="me")return this.showResults(this._contacts.filter(function(e){return!e.hide&&e.me}).concat(this._contacts.filter(function(e){return!e.hide&&(n.test(e.username)||n.test(e.realname)||n.test(e.email))})));if(this._isEmail(e))return this.select({email:e,nsid:null});if(/,/.test(e))return this.select(null);if(!this._contacts)return this.showResults(),this.options.signedOut?null:this.load(this.search.bind(this));this.showResults(this._contacts.filter(function(e){return!e.hide&&(n.test(e.username)||n.test(e.realname)||n.test(e.email))}))},_isEmail:function(e,t){/,/.test(e)?e=e.split(/,/):e=[e];var n=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;if(t){while(e.length)if(n.test(e.shift().trim()))return!0;return!1}while(e.length)if(!n.test(e.shift().trim()))return!1;return!0},showResults:function(e){var t=this.options.max||10,n,r,i=this;n=document.createDocumentFragment(),!e&&this.options.loadingState?(r=document.createElement("li"),r.className="loading",r.innerHTML=this.options.loadingState,n.appendChild(r)):e&&e.length===0?(r=document.createElement("li"),r.innerHTML='<span class="no-contacts">No contacts found.</span>',n.appendChild(r)):e&&e.slice(0,t).forEach(function(e){var t=i.createItem(e);n.appendChild(t)}),this.listEl.setHTML(""),this.listEl.getDOMNode().appendChild(n),this.show()},_template:['<img src="{{buddyicon}}">',"<h2>{{realname}}</h2>","<h3>{{username}}</h3>"].join(""),createItem:function(t){var n=document.createElement("li"),r,i=this.options.truncateLength||70;return r=this._template.replace(/\{\{(\w+)\}\}/g,function(n,r){if(r==="buddyicon")return t[r];var s=e.flutil.escapeInput(t[r]);return e.Handlebars.helpers.truncate(s,i)}),n.innerHTML=r,n.dataset?(n.dataset=n.dataset,n.dataset.nsid=t.nsid,n.dataset.realname=t.realname,n.dataset.pathAlias=t.pathAlias):(n.setAttribute("data-nsid",t.nsid),n.setAttribute("data-displayname",t.realname),n.setAttribute("data-pathAlias",t.pathAlias)),n}},e.ContactSearchBox=t},"@VERSION@",{requires:["flutil","contact-search-css","handlebars-helpers","flickr-contacts-getListfetcher"]});
YUI.add("hermes-template-share",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.facebook),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(4,d,t),fn:a.program(2,p,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function p(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n			'}function d(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n			',r}function v(e,t){return"connect"}function m(e,t){return"composesignedout"}function g(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="facebook"><i class="ui-icon-big-facebook"></i></button>\n		'}function y(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.twitter),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(14,w,t),fn:a.program(12,b,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function b(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n			'}function w(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n			',r}function E(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="twitter"><i class="ui-icon-big-twitter"></i></button>\n		'}function S(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.tumblr),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(21,T,t),fn:a.program(19,x,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function x(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n			'}function T(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n			',r}function N(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="tumblr"><i class="ui-icon-big-tumblr"></i></button>\n		'}function C(e,t){var r="",i;r+='\n			<button class="ui-button ui-button-logo" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(26,k,t),data:t});if(i||i===0)r+=i;return r+='" data-network="mail"><i class="ui-icon-big-mail"></i></button>\n		',r}function k(e,t){return"compose"}function L(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="mail"><i class="ui-icon-big-mail"></i></button>\n		'}function A(e,t){var r="",i;r+='\n			<button class="ui-button ui-button-logo" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(26,k,t),data:t});if(i||i===0)r+=i;return r+='" data-network="pinterest"><i class="ui-icon-big-pinterest"></i></button>\n		',r}function O(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="pinterest"><i class="ui-icon-big-pinterest"></i></button>\n		'}function M(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.wordpress),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(37,D,t),fn:a.program(35,_,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function _(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="wordpress"><i class="ui-icon-big-wordpress"></i></button>\n			'}function D(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="wordpress"><i class="ui-icon-big-wordpress"></i></button>\n			',r}function P(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="wordpress"><i class="ui-icon-big-wordpress"></i></button>\n		'}function H(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.blogger),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(44,j,t),fn:a.program(42,B,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function B(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="blogger"><i class="ui-icon-big-blogger"></i></button>\n			'}function j(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="',i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="blogger"><i class="ui-icon-big-blogger"></i></button>\n			',r}function F(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="blogger"><i class="ui-icon-big-blogger"></i></button>\n		'}function I(e,t){var r="",i,s;r+="\n			",s=n["if"].call(e,(i=(i=e.networks,i==null||i===!1?i:i.livejournal),i==null||i===!1?i:i.accounts),{hash:{},inverse:a.program(51,R,t),fn:a.program(49,q,t),data:t});if(s||s===0)r+=s;return r+="\n		",r}function q(e,t){return'\n				<button class="ui-button ui-button-logo" data-action="compose" data-network="livejournal"><i class="ui-icon-big-livejournal"></i></button>\n			'}function R(e,t){var r="",i;r+='\n				<button class="ui-button ui-button-logo c-button-connect" data-action="'
,i=n["if"].call(e,e.user,{hash:{},inverse:a.program(7,m,t),fn:a.program(5,v,t),data:t});if(i||i===0)r+=i;return r+='" data-network="livejournal"><i class="ui-icon-big-livejournal"></i></button>\n			',r}function U(e,t){return'\n			<button class="ui-button ui-button-logo ui-button-disabled" data-action="halt" data-network="livejournal"><i class="ui-icon-big-livejournal"></i></button>\n		'}function z(e,t,r){var i="",s,o,u;i+='\n	<div class="ui-charmtabs c-share-linkembed">\n		<ul class="ui-charmtabs-icons">\n			<li data-tab="link" data-action="switch"><i class="ui-icon-small-link"></i></li>\n			<li data-tab="html" data-action="switch"><i class="ui-icon-small-embedhtml"></i></li>\n			<li data-tab="bbcode" data-action="switch"><i class="ui-icon-small-embedbbcode"></i></li>\n		</ul>\n		<div class="ui-charmtabs-content">\n			<span class=\'photo-charm-indicator hide-text\'>\u2191</span>\n\n			<div data-tab="link" class="ui-charmtabs-contentitem-selected">\n				<!-- LINK -->\n				<h3>Link to this photo:</h3>\n				<input type="text" value="',u={hash:{},data:t},i+=l((s=n.shortUrlPhoto||r.shortUrlPhoto,s?s.call(e,r.model,r.https,u):c.call(e,"shortUrlPhoto",r.model,r.https,u)))+'">\n				<!-- /LINK -->\n			</div>\n\n			<div data-tab="html">\n				<!-- HTMLCODE -->\n				',o=n["if"].call(e,e.canShowPlayr,{hash:{},inverse:a.program(74,et,t),fn:a.program(56,W,t),data:t});if(o||o===0)i+=o;i+='\n				<!-- /HTMLCODE -->\n			</div>\n\n			<div data-tab="bbcode">\n				<!-- BBCODE -->\n				',o=n["if"].call(e,e.canShowPlayr,{hash:{},inverse:a.program(74,et,t),fn:a.program(79,rt,t),data:t});if(o||o===0)i+=o;return i+="\n				<!-- /BBCODE -->\n			</div>\n\n		</div>\n	</div>\n	",i}function W(e,t){var r="",i,s;r+='\n				<div class="ui-dropdown ui-dropdown-closed c-share-linkembed-embedsizedd">\n					<span class="ui-dialog-arrow"></span>\n					<ul>\n						',s=n.each.call(e,(i=e.model,i==null||i===!1?i:i.sizes),{hash:{},inverse:a.noop,fn:a.programWithDepth(57,X,t,e),data:t});if(s||s===0)r+=s;return r+='\n					</ul>\n				</div>\n				<input type="text" name="embedcode" class="c-share-linkembed-embedcode">\n				',r}function X(e,t,r){var i="",s,o,u;i+='\n						<li data-action="set" data-value="'+l((s=(s=t,s==null||s===!1?s:s.key),typeof s===f?s.apply(e):s))+'" data-text="',u={hash:{},inverse:a.noop,fn:a.program(58,V,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","sq,q",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","sq,q",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(60,$,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","t",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","t",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(62,J,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","s,n",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","s,n",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(64,K,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(66,Q,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(68,G,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","o",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","o",u));if(o||o===0)i+=o;i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+" x ",(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'">\n							',u={hash:{},inverse:a.noop,fn:a.program(58,V,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","sq,q",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","sq,q",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(60,$,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","t",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","t",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(62,J,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","s,n",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","s,n",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(64,K,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(66,Q,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(68,G,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","o",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","o",u));if(o||o===0)i+=o;i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+" x ",(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'\n							<script type="text/x-embedcode">\n								',o=n["if"].call(e,r.playr,{hash:{},inverse:a.programWithDepth(72,Z,t,e),fn:a.programWithDepth(70,Y,t,r),data:t});if(o||o===0)i+=o;return i+="\n							</script>\n						</li>\n						",i}function V(e,t){return"Square"}function $(e,t){return"Thumbnail"}function J(e,t){return"Small"}function K(e,t){return"Medium"}function Q(e,t){return"Large"}function G(e,t){return"Original"}function Y(e,t,r){var i="",s,o;return i+='\n									<iframe src="'+l((s=r.playrUrl,typeof s===f?s.apply(e):s))+'" width="',(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+'" height="',(o=n.height)?o=o.call(e,{hash
:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>\n								',i}function Z(e,t,r){var i="",s,o,u;return i+='\n									<a href="',u={hash:{},data:t},i+=l((s=n.shortUrlPhoto||r.shortUrlPhoto,s?s.call(e,r.model,r.https,u):c.call(e,"shortUrlPhoto",r.model,r.https,u)))+'" title="',u={hash:{},data:t},i+=l((s=n.fallback||r.fallback,s?s.call(e,(s=r.model,s==null||s===!1?s:s.title),"Untitled",u):c.call(e,"fallback",(s=r.model,s==null||s===!1?s:s.title),"Untitled",u)))+" by "+l((s=(s=(s=r.model,s==null||s===!1?s:s.owner),s==null||s===!1?s:s.displayname),typeof s===f?s.apply(e):s))+', on Flickr"><img src="http:',(o=n.url)?o=o.call(e,{hash:{},data:t}):(o=e.url,o=typeof o===f?o.apply(e):o),i+=l(o)+'" width="',(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+'" height="',(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'" alt="',u={hash:{},data:t},i+=l((s=n.fallback||r.fallback,s?s.call(e,(s=r.model,s==null||s===!1?s:s.title),"Untitled",u):c.call(e,"fallback",(s=r.model,s==null||s===!1?s:s.title),"Untitled",u)))+'"></a>\n								',i}function et(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.isOwner,{hash:{},inverse:a.program(77,nt,t),fn:a.program(75,tt,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function tt(e,t){return"\n						<p>Please share this photo publicly to view embed code</p>\n					"}function nt(e,t){return"\n						<p>Sharing is restricted for this photo</p>\n					"}function rt(e,t){var r="",i,s;r+='\n				<div class="ui-dropdown ui-dropdown-closed c-share-linkembed-embedsizedd">\n					<span class="ui-dialog-arrow"></span>\n					<ul>\n						',s=n.each.call(e,(i=e.model,i==null||i===!1?i:i.sizes),{hash:{},inverse:a.noop,fn:a.programWithDepth(80,it,t,e),data:t});if(s||s===0)r+=s;return r+='\n					</ul>\n				</div>\n				<input type="text" name="embedcode" class="c-share-linkembed-embedcode">\n				',r}function it(e,t,r){var i="",s,o,u;i+='\n						<li data-action="set" data-value="'+l((s=(s=t,s==null||s===!1?s:s.key),typeof s===f?s.apply(e):s))+'" data-text="',u={hash:{},inverse:a.noop,fn:a.program(58,V,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","sq,q",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","sq,q",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(60,$,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","t",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","t",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(62,J,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","s,n",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","s,n",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(64,K,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(66,Q,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u));if(o||o===0)i+=o;u={hash:{},inverse:a.noop,fn:a.program(68,G,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","o",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","o",u));if(o||o===0)i+=o;i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+" x ",(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'">\n							',u={hash:{},inverse:a.noop,fn:a.program(58,V,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","sq,q",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","sq,q",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(60,$,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","t",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","t",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(62,J,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","s,n",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","s,n",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(64,K,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","m,z,c",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(66,Q,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","l,h,k",u));if(o||o===0)i+=o;i+="\n							",u={hash:{},inverse:a.noop,fn:a.program(68,G,t),data:t},o=(s=n.ifCond||e.ifCond,s?s.call(e,(s=t,s==null||s===!1?s:s.key),"in","o",u):c.call(e,"ifCond",(s=t,s==null||s===!1?s:s.key),"in","o",u));if(o||o===0)i+=o;return i+=" ",(o=n.width)?o=o.call(e,{hash:{},data:t}):(o=e.width,o=typeof o===f?o.apply(e):o),i+=l(o)+" x ",(o=n.height)?o=o.call(e,{hash:{},data:t}):(o=e.height,o=typeof o===f?o.apply(e):o),i+=l(o)+'\n							<script type="text/x-embedcode">\n								[url=',u={hash:{},data:t},i+=l((s=n.shortUrlPhoto||r.shortUrlPhoto,s?s.call(e,r.model,r.https,u):c.call(e,"shortUrlPhoto",r.model,r.https,u)))+"][img]http:",(o=n.url)?o=o.call(e,{hash:{},data:t}):(o=e.url,o=typeof o===f?o.apply(e):o),i+=l(o)+"[/img][/url]\n							</script>\n						</li>\n						",i}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=this,f="function",l=this.escapeExpression,c=n.helperMissing;s+='<div class="ui-dialog-wrapper c-share-menu">\n\n	<div class="ui-buttonbar c-share-networks">\n\n		',u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.facebook),{hash:{},inverse:a.program(9,g,i),fn:a.program(1,h,i),data:i});if(u||u===0)s+=u;s+="\n\n		"
,u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.twitter),{hash:{},inverse:a.program(16,E,i),fn:a.program(11,y,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.tumblr),{hash:{},inverse:a.program(23,N,i),fn:a.program(18,S,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.mail),{hash:{},inverse:a.program(28,L,i),fn:a.program(25,C,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.pinterest),{hash:{},inverse:a.program(32,O,i),fn:a.program(30,A,i),data:i});if(u||u===0)s+=u;s+='\n\n		<button class="ui-button ui-button-logo" data-action="expand"><i class="ui-icon-big-more"></i></button>\n\n	</div>\n\n	<div class="ui-buttonbar c-share-networks ui-util-removed" data-target="expand">\n\n		<!-- below the fold -->\n\n		',u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.wordpress),{hash:{},inverse:a.program(39,P,i),fn:a.program(34,M,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.blogger),{hash:{},inverse:a.program(46,F,i),fn:a.program(41,H,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=t.networks,o==null||o===!1?o:o.livejournal),{hash:{},inverse:a.program(53,U,i),fn:a.program(48,I,i),data:i});if(u||u===0)s+=u;s+='\n\n		<button class="ui-button ui-button-logo ui-button-disabled" style="visibility: hidden;"><i class="ui-icon-big-noop"></i></button>\n\n		<button class="ui-button ui-button-logo ui-button-disabled" style="visibility: hidden;"><i class="ui-icon-big-noop"></i></button>\n\n		<button class="ui-button ui-button-logo ui-button-disabled" style="visibility: hidden;"><i class="ui-icon-big-noop"></i></button>\n\n	</div>\n	\n	',u=n.unless.call(t,(o=t.model,o==null||o===!1?o:o.isVideo),{hash:{},inverse:a.noop,fn:a.programWithDepth(55,z,i,t),data:i});if(u||u===0)s+=u;return s+="\n\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-facebook",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-facebook">\n\n	<h1><i class="ui-icon-small-facebook"></i>Share on Facebook</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+a((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===u?o.apply(t):o))+'</legend>\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		please authorize Flickr to post on Facebook\n	</div>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-facebook",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-twitter",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		| <select data-field="account" class="c-share-dropdown-account">\n			',s=n.each.call(e,(i=(i=e.networks,i==null||i===!1?i:i.twitter),i==null||i===!1?i:i.accounts),{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n		</select>\n		",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">@',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</option>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-twitter">\n	<h1>\n		<i class="ui-icon-small-twitter"></i>\n		Share on Twitter\n		',a={hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,(o=(o=(o=t.networks,o==null||o===!1?o:o.twitter),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a):h.call(t,"ifCond",(o=(o=(o=t.networks,o==null||o===!1?o:o.twitter),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a));if(u||u===0)s+=u;return s+='\n	</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+l((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</legend>\n			<div class="c-share-twitter-charcounter">\n				<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n				<span data-field="message-counter">120</span>\n			</div>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		please authorize Flickr to post on Twitter\n	</div>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-twitter",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-mail",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-mail">\n\n	<h1><i class="ui-icon-small-mail"></i>Share via mail</h1>\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+a((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===u?o.apply(t):o))+'</legend>\n			<input type="text" class="ui-u-1" placeholder="screen name or email" data-field="recipient">\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-mail",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-tumblr",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;r+='\n		| <select data-field="account" class="c-share-dropdown-account">\n			',s=n.each.call(e,(i=(i=e.networks,i==null||i===!1?i:i.tumblr),i==null||i===!1?i:i.accounts),{hash:{},inverse:c.noop,fn:c.program(2,d,t),data:t});if(s||s===0)r+=s;return r+="\n		</select>\n		",r}function d(e,t){var r="",i;return r+='\n			<option value="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===f?i.apply(e):i),r+=l(i)+'">@',(i=n.name)?i=i.call(e,{hash:{},data:t}):(i=e.name,i=typeof i===f?i.apply(e):i),r+=l(i)+"</option>\n			",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-tumblr">\n	<h1>\n		<i class="ui-icon-small-tumblr"></i>\n		Share on Tumblr\n		',a={hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,(o=(o=(o=t.networks,o==null||o===!1?o:o.tumblr),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a):h.call(t,"ifCond",(o=(o=(o=t.networks,o==null||o===!1?o:o.tumblr),o==null||o===!1?o:o.accounts),o==null||o===!1?o:o.length),">",1,a));if(u||u===0)s+=u;return s+='\n	</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend style="max-width: 280px;">'+l((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</legend>\n			<select data-field="publishing" class="c-share-dropdown-publishing">\n				<option value="publish">Publish now</option>\n				<option value="queue">Add to queue</option>\n				<option value="draft">Save as draft</option>\n			</select>\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		please authorize Flickr to post on Tumblr\n	</div>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-tumblr",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-blogger",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<div class="ui-dialog-wrapper c-share-compose c-share-compose-blogger">\n\n	<h1><i class="ui-icon-small-blogger"></i>Share on Blogger</h1>\n\n	<form class="ui-form">\n		<fieldset>\n			<legend>'+a((o=(o=t.photo,o==null||o===!1?o:o.title),typeof o===u?o.apply(t):o))+'</legend>\n			<textarea class="ui-u-1" placeholder="Include a message" data-field="message"></textarea>\n		</fieldset>\n		<div class="ui-buttonbar ui-util-alignright">\n			<button type="submit" class="ui-button ui-button-cta" data-action="post"><span>Share Photo</span></button>\n		</div>\n	</form>\n\n	<div class="c-share-compose-connect">\n		<i>&harr;</i>\n		please authorize Flickr to post on Blogger\n	</div>\n\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-blogger",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-link-tumblr",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing;return s+='<a href="',(o=n.pageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.pageUrl,o=typeof o===f?o.apply(t):o),s+=l(o)+'" title="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'">',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'</a> by <a href="',(u=n.ownerUrl)?u=u.call(t,{hash:{},data:i}):(u=t.ownerUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">'+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+"</a> on Flickr.",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-link-tumblr",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-link-blogger",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing;return s+='<div style="font-size: 0.8em; line-height: 1.6em; margin: 0 0 10px 0; padding: 0;">\n	<a href="',(o=n.pageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.pageUrl,o=typeof o===f?o.apply(t):o),s+=l(o)+'" title="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'"><img alt="',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+" by "+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+'" src="'+l((o=(o=t.imgSize,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'" style="max-width: 100%"></a>\n	<span style="margin: 0;"><a href="',(u=n.pageUrl)?u=u.call(t,{hash:{},data:i}):(u=t.pageUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">',a={hash:{},data:i},s+=l((o=n.fallback||t.fallback,o?o.call(t,(o=t.model,o==null||o===!1?o:o.title),"Untitled",a):c.call(t,"fallback",(o=t.model,o==null||o===!1?o:o.title),"Untitled",a)))+'</a>, a photo by <a href="',(u=n.ownerUrl)?u=u.call(t,{hash:{},data:i}):(u=t.ownerUrl,u=typeof u===f?u.apply(t):u),s+=l(u)+'">'+l((o=(o=(o=t.model,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+"</a> on Flickr.</span>\n</div>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-link-blogger",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("share-view",function(e){var t=e.Views.dialogs["dialog-tooltip"],n={},r,i,s,o,u;u={debug:!1,transitionTimeout:2e3,defaultEmbedSize:"m",defaultTab:"html",noPlayrTab:"link",shareRedirectURL:"https://www.flickr.com/authorize.gne?client=1",networks:{facebook:{clientId:e.config.flickr.facebook.client_id,scope:"offline_access,read_stream,publish_stream,publish_actions",authorizeUrl:"https://www.facebook.com/dialog/oauth",signedOutShareUrl:"https://www.facebook.com/dialog/feed"},twitter:{signedOutShareUrl:"https://twitter.com/share"},tumblr:{signedOutShareUrl:"https://www.tumblr.com/share/photo",shareSize:"c"},pinterest:{defaultDescription:"Flickr photo",signedOutShareUrl:"https://www.pinterest.com/pin/create/button/",shareSize:"c"},blogger:{clientId:e.config.flickr.blogger.client_id,scope:"https://www.googleapis.com/auth/blogger",authorizeUrl:"https://accounts.google.com/o/oauth2/auth",signedOutShareUrl:"https://www.blogger.com/blog_this.pyra",shareSize:"c"}},css:{locked:"ui-util-locked",working:"ui-util-working",removed:"ui-util-removed",shim:"c-share-autocomplete-shim",embedTabs:".c-share-linkembed",embedSizeDropdown:".c-share-linkembed-embedsizedd",embedCode:".c-share-linkembed-embedcode"}},o=e.merge(e.flutil,{log:function(){if(!u.debug||!console.log.apply)return;var e=[].slice.call(arguments);e.unshift("SHARE"),o.dump.apply(null,e)}}),e.namespace("Views")[this.name]=e.Base.create("share-view",t,[],{initializer:function(n){var r,i=["photo","photostream","set"];this.api=this.appContext.flickrAPI,this.appContext=this.appContext,this.appContext.flipper.isFlipped("https_everything")||this.desecureLinks(),t.prototype.initializer.call(this,n);while(r=i.shift())if(n[r+"Id"]){this.set("modelName",r),this.set("modelId",n[r+"Id"]);break}if(!r)throw new Error("A photo or photolist id is required");return this.set("user",this.appContext.getViewer().signedIn?{}:null),e.Views.dialog.registerView(this,this.modelId),this},initialize:function(){return this.loadState()},getPlayrUrl:function(e){var t,n;return t=document.location.pathname,t=t.replace(/\/+$/,""),t+="/player/",n=this.appContext.flipper.isFlipped("https_everything")?"https":"http",n+"://www.flickr.com"+t},canShowPlayr:function(){var e=this.get("engagement"),t=this.get("privacy"),n=!1;return e&&t&&(n=e.getValue("canShare")&&t.getValue("isPublic")),n},loadState:function(){var t=this,n,r,i,s;return n=this.appContext.getModel(this.get("modelName")+"-models",this.get("modelId")),r=this.appContext.getModel(this.get("modelName")+"-privacy-models",this.get("modelId")),i=this.appContext.getModel(this.get("modelName")+"-engagement-models",this.get("modelId")),s=new e.FlickrPromise({model:n,privacy:r,engagement:i}),s.then(function(e){t.set("model",e.model),t.set("modelName",e.model.registry.name.split("-")[0]),t.set("privacy",e.privacy),t.set("engagement",e.engagement)}).then(function(){return t.mapLinkedAccounts()}).then(function(e){o.log("NETWORKS",t.get("networks")),t.openShareMenu()}).then(null,this.handleError("loadState"))},hide:function(e){var n=this;this._socialNet&&this._socialNet.close(),t.prototype.hide.call(this,function(){n.get("container").get("parentNode")&&n.openShareMenu(),e&&e()})},show:function(e){t.prototype.show.call(this,e),this.embedTabs&&this.embedTabs.refreshLayout()},desecureLinks:function(){var e;u.shareRedirectURL=u.shareRedirectURL.replace("https://","http://"),Object.keys(u.networks).forEach(function(t){e=u.networks[t],e.authorizeUrl&&(u.networks[t].authorizeUrl=e.authorizeUrl.replace("https://","http://")),e.signedOutShareUrl&&(u.networks[t].signedOutShareUrl=e.signedOutShareUrl.replace("https://","http://"))})},openShareMenu:function(){var t=this,n=this.canShowPlayr(),r=this.get("engagement");this.embedHtmlSizeDd&&this.embedHtmlSizeDd.destroy(),this.embedBbcodeSizeDd&&this.embedBbcodeSizeDd.destroy(),this.embedTabs&&this.embedTabs.destroy(),this.set("playrUrl",this.getPlayrUrl()),this.set("playr",this.appContext.flipper.isFlipped("playr")),this.set("canShowPlayr",n),this.set("isOwner",r&&r.getValue("isOwner")),this.set("https",this.appContext.flipper.isFlipped("https_everything")),this.set("content",this.templates("share")),this.renderContent();if(!this.get("model"))return;if(this.get("model").getValue("isVideo"))return;this.embedTabs=new e.Views.CharmTabs({appContext:this.appContext,container:this.get("container").one(u.css.embedTabs),selected:n?u.defaultTab:u.noPlayrTab}),this.embedTabs.on("selected",function(e){setTimeout(function(){var t=e.contentEl.one("input");if(t)try{t.focus()}catch(n){}},10)}),n&&(this.embedHtmlSizeDd=new e.Views.Dropdown({appContext:this.appContext,container:this.embedTabs.getTab("html").contentEl.one(u.css.embedSizeDropdown),selected:u.defaultEmbedSize}),this.embedHtmlSizeDd.on("selected",function(e){t.setEmbedCode(e.value,e.listItemEl)}),this.embedHtmlSizeDd.select(u.defaultEmbedSize),this.embedBbcodeSizeDd=new e.Views.Dropdown({appContext:this.appContext,container:this.embedTabs.getTab("bbcode").contentEl.one(u.css.embedSizeDropdown),selected:u.defaultEmbedSize}),this.embedBbcodeSizeDd.on("selected",function(e){t.setEmbedCode(e.value,e.listItemEl)}),this.embedBbcodeSizeDd.select(u.defaultEmbedSize))},setEmbedCode:function(e,t){var n=t.ancestor("[data-tab]").one(u.css.embedCode),r=t.one("script").get("innerHTML").trim();n.setAttribute("value",r),n.getDOMNode().select()},openComposeDialog:function(t){var n,r=this;this._socialNet=n=new t({appContext:this.appContext,model:this.get("model"),privacy:this.get("privacy"),networks:this.get("networks"),parent:this,signedOut:!this.get("user")}),e.rapidTracker.beacon(r.name,"share"+n.get("serviceName")+"NetworkClick"),n.on("posted",function(){r.switchToUIState("complete"),e.rapidTracker.beacon(r.name,"photoSharedTo"+n.get("serviceName")),setTimeout(function(){r.hide(function(){r.switchToUIState("complete",!1),r._socialNet.close(),r._socialNet=null})},2e3)}),n.on("dismissed",function(e){r.hide(function(){r._socialNet.close(),r._socialNet=null})}),n.render
(),n.activate(),r.set("content",n),r.renderContent()},openSignedOutComposeDialog:function(t){var n;this._socialNet=n=new t({appContext:this.appContext,model:this.get("model"),privacy:this.get("privacy"),networks:this.get("networks"),parent:this,signedOut:!this.get("user")}),e.rapidTracker.beacon(this.name,"share"+n.get("serviceName")+"SignedOutNetworkClick"),this._socialNet.composeSignedOut()},openAuthorizeDialog:function(e){this.openComposeDialog(e),this._socialNet.linkAccount()},activate:function(){var e,r=this;return t.prototype.activate.call(this),e={":compose":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);r.openComposeDialog(n[i])},":composesignedout":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);r.openSignedOutComposeDialog(n[i])},":connect":function(e,t){e.halt();var i="Connect"+o.toCamelCase(t.network);this.get("user")?r.openAuthorizeDialog(n[i]):r.openComposeDialog(n[i])},":expand":function(e,t){e.halt(),r.get("container").one('[data-target="expand"]').toggleClass(u.css.removed)}},this.attachEvents(e),this},handleError:function(t,n){var r=["loadState","flickr.sharing.getServiceTypes","flickr.sharing.getServices","flickr.sharing.canShare"];return r.indexOf(t)>=0?function(e){o.log(t,!e.toString||e.toString().match(/^\[object/)?e:e.toString())}:function(n){o.log(t,!n.toString||n.toString().match(/^\[object/)?n:n.toString()),e.Views.dialog.getInstance("dialog-alert",{content:"Something went wrong.<br>Please refresh your browser and try again.",attrs:{level:"warning"},appContext:this.appContext}).show()}.bind(this)},mapLinkedAccounts:function(){var e=this;return this.getLinkedAccounts().then(function(t){e.get("networks")||e.set("networks",{});var n=e.get("networks");Object.keys(t).forEach(function(e){n[t[e].label]=t[e]})})},getLinkedAccounts:function(){return e.batch(this.get("user")?this.api.callMethod("flickr.sharing.getServices",{}):new e.AutoResolvingPromise,this.getNetworks()).then(function(e){var t=e[0],n=e[1]||[],r;try{r=t.services.service||[]}catch(i){r=[]}return r=r.reduce(function(e,t){var n=t.typeId+"";return e[n]||(e[n]=[]),e[n].push(t),e},{}),Object.keys(n).forEach(function(e){n[e].accounts=r[n[e].id]||null}),n},this.handleError("flickr.sharing.getServices"))},getNetworks:function(){var t=this,n,r;return n=["facebook","twitter","tumblr","mail","pinterest"],this.appContext.flipper.isFlipped("more-sharing-services")&&(n=n.concat(["blogger","wordpress","livejournal"])),r=["mail"],this.getNetworkMap().then(function(){var i={},s,o;return i[t.get("modelName")+"_id"]=t.get("model").id,t.get("user")?t.api.callMethod("flickr.sharing.canShare",i):(o=t.get("engagement").getValue("canShare")?n:r,s=o.map(function(e){var n,r,i;for(n in t._networkMap){r=t._networkMap[n],i={service_type_id:n};if(r.label===e){i.can_share=1;break}}return i.can_share||(i.can_share=0),i}),new e.AutoResolvingPromise({services:{service:s}}))}).then(function(e){var r;try{r=e.services.service||[]}catch(i){r=[]}return r.push({service_type_id:999,can_share:r.filter(function(e){return e.service_type_id.toString()==="9"&&e.can_share}).length}),r=r.filter(function(e){return e.can_share}).reduce(function(e,r){var i=r.service_type_id+"",s=t._networkMap[i]||{name:"unknown",label:i};return n.indexOf(s.label)<0?e:(e[i]={name:s.name,label:s.label,id:i},e)},{}),r},this.handleError("flickr.sharing.canShare"))},getNetworkMap:function(){var t=this;return this._networkMap={3:{label:"blogger",name:"Blogger"},5:{label:"livejournal",name:"LiveJournal"},7:{label:"wordpress",name:"WordPress"},9:{label:"twitter",name:"Twitter"},12:{label:"tumblr",name:"Tumblr"},128:{label:"facebook",name:"Facebook"},129:{label:"yahoo-pulse",name:"Yahoo Pulse"},130:{label:"mail",name:"Mail"},999:{label:"pinterest",name:"Pinterest"}},this._networkMap?new e.AutoResolvingPromise:this.api.callMethod("flickr.sharing.getServiceTypes",{}).then(function(e){var n;try{n=e.service_types.service_type||[]}catch(r){n=[]}t._networkMap=n.reduce(function(e,t){return e[t.id.toString()]={label:t.content.toLowerCase().replace(/\s+/,"-"),name:t.content},e},{})},this.handleError("flickr.sharing.getServiceTypes"))},destructor:function(){this._socialNet&&this._socialNet.close(),t.prototype.destroy.call(this),this.detachAll()},isDebug:function(){return u.debug}}),r=n.Connect=function(t){this.options=e.merge(t),e.FlickrView.apply(this,arguments)},e.extend(r,e.FlickrView,{initializer:function(){this.api=this.options.appContext.flickrAPI,this.appContext=this.options.appContext,this.parent=this.options.parent,this.set("model",this.options.model),this.set("privacy",this.options.privacy),this.set("networks",this.options.networks),this.set("signedOut",this.options.signedOut),this.set("modelName",this.options.model.registry.name.split("-")[0]),this.set(this.get("modelName"),this.get("model"))},isPrivate:function(){var e=this.get("privacy");return!e.getValue("isPublic")&&!e.getValue("isVisibleByFriends")&&!e.getValue("isVisibleByFamily")},toJSON:function(){var t=this.getAttrs();return Object.keys(t).reduce(function(n,r){var i=t[r];return i instanceof e.Node?n:i instanceof e.FlickrView?n:(i&&i.toJSON&&(i=i.toJSON()),n[r]=i,n)},{})},render:function(){var e=this.templates(this.get("template"))(this.toJSON());return this.get("container").setHTML(e),this},activate:function(){var e={":post":this.post};return this.attachEvents(e),this},handleError:function(e,t){var n=this;return function(r){o.log(e,!r.toString||r.toString().match(/^\[object/)?r:r.toString());if(["10","12","98","99"].indexOf(r.code+"")>=0)return n.linkAccount().then(t);n.parent.handleError(n._class+":"+e)(r)}},handleRetry:function(){var e=this,t=Array.prototype.slice.call(arguments);return function(){t[0].apply(e,t.slice(1))}},linkAccount:function(){var t=this;return new e.FlickrPromise(function(e,n){t.authorize(function(n){var r={};r.token=n.token,r.service_type_id=t.get("serviceType"),n.hasOwnProperty("expiresIn")&&(r.expires=n.expiresIn/1e3|0||0),n.hasOwnProperty("verifier")&&(r.verifier=
n.verifier),t.api.callMethod("flickr.sharing.setToken",r).then(function(n){t.parent.mapLinkedAccounts().then(function(){o.log("NETWORKS-REFRESH",t.get("networks")),e()})})})})},authorize:function(t){var n=this.get("serviceName"),r,i=this;r=e.Views.dialog.getInstance("dialog-cta",{content:"You need to authorize Flickr to share photos on your "+n,attrs:{title:"Connect to "+n,confirmButtonText:"Ok, take me to my settings"},appContext:i.appContext}),r.on("confirm",function(){document.location="/account/sharing/"}),r.show()},destructor:function(){this._oauthWin&&this._oauthWin.close();var t=this.get("container");t.detach(),t.remove(),this.set("container",null),this.options=null,this.api=null,this.appContext=null,this.set("model",null),this.set("privacy",null),e.FlickrView.prototype.destroy.call(this)},close:function(){this.destructor()}}),r.ATTRS=e.merge(e.FlickrView.ATTRS,{template:{value:"share-modal"},serviceType:{value:"000"},serviceName:{value:"Default"},container:{valueFn:function(){return e.Node.create("<div/>")}}}),n.ConnectFacebook=function(){this._class="ConnectFacebook",r.apply(this,arguments)},e.extend(n.ConnectFacebook,r,{post:function(t){var n={},r=this;return t.halt(),n[this.get("modelName")+"_id"]=this.get("model").id,n.service_type_id=this.get("serviceType"),n.facebook_privacy="friends",this.isPrivate()&&(n.guestpass_private="1"),n.message=o.escapeInput(this.get("container").one('[data-field="message"]').get("value"),"text"),o.log("POST TO FB",n),this.get("container").addClass(u.css.working),e.UA.ie&&r._oauthWin&&r._oauthWin.close(),this.api.callMethod("flickr.sharing.post",n).then(function(e){r.get("container").removeClass(u.css.working),r.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,t)))},composeSignedOut:function(){var t,n,r=this;t={app_id:e.config.flickr.facebook.client_id,display:"popup",link:document.location.href,name:this.get("model").getValue("title"),description:this.get("model").getValue("description"),redirect_uri:u.shareRedirectURL},u.debug&&(t.link=t.link.replace("local.flickr.com","www.flickr.com")),o.log("ANON POST TO FB",t),this.get("container").addClass(u.css.working),n=o.buildHttpQuery(u.networks.facebook.signedOutShareUrl,t),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(n,{onClose:function(){},onUrlChange:function(){var t,n,i;try{t=r._shareWin.document.location,n=[t.protocol,"//",t.host,t.pathname].join(""),i=u.shareRedirectURL.split("?")[0],u.debug&&n.replace("local.flickr.com","www.flickr.com"),n===i&&r._shareWin&&r._shareWin.close()}catch(s){e.UA.ie&&r._oauthWin&&r._oauthWin.close()}},ui:{}})},authorize:function(e){var t,n,r=this,i;t={client_id:u.networks.facebook.clientId,redirect_uri:u.shareRedirectURL,response_type:"token",scope:u.networks.facebook.scope,display:"popup"},n=o.buildHttpQuery(u.networks.facebook.authorizeUrl,t),i=function(){var t,n;try{t=r._oauthWin.location.hash||""}catch(i){t=""}n=t.slice(1).split(/&/).reduce(function(e,t){var n=t.split(/=/);return e[n[0]]=n[1],e},{}),n.access_token&&(r._oauthWin&&r._oauthWin.close(),e({token:n.access_token,expiresIn:(parseInt(n.expires_in,10)||0)*1e3}))},this._oauthWin&&this._oauthWin.close(),this._oauthWin=o.openPopupWindow(n,{onUrlChange:i,ui:{}})}}),n.ConnectFacebook.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-facebook"},serviceType:{value:"128"},serviceName:{value:"Facebook"}}),n.ConnectTwitter=function(){this._class="ConnectTwitter",r.apply(this,arguments)},e.extend(n.ConnectTwitter,r,{activate:function(){r.prototype.activate.call(this);var e=this.get("container"),t=e.one('[data-field="message"]'),n=e.one('[data-field="message-counter"]'),i,s=120;i=t.on("keydown",function(){var r=o.escapeInput(t.get("value"),"text");n.setHTML(""+(s-r.length)),n[r.length>s?"addClass":"removeClass"]("c-share-twitter-charcounter-overflow"),e[r.length>s?"addClass":"removeClass"](u.css.locked)}),this.registerEventHandler(i)},render:function(){r.prototype.render.call(this),this.accountDd=new s(this.get("container").one('[data-field="account"]'))},authorize:function(e){var t={},n=this,r=this.get("container"),i,s,a=!1;t.service_type_id=this.get("serviceType"),r.addClass(u.css.connecting),i=function(){var t=n._oauthWin.location.search||"",i=n._oauthWin.location.hostname||"",o;o=t.slice(1).split(/&/).reduce(function(e,t){var n=t.split(/=/);return e[n[0]]=n[1],e},{});if(o.oauth_token)return a=!0,n._oauthWin.close(),r.removeClass(u.css.connecting),e({token:o.oauth_token,verifier:o.oauth_verifier});i==="www.flickr.com"&&s()},s=function(){n._oauthWin.close();if(a)return;r.removeClass(u.css.connecting),n.fire("dismissed")},this.api.callMethod("flickr.sharing.getAuthorizeUrl",t).then(function(e){n._oauthWin&&n._oauthWin.close(),n._oauthWin=o.openPopupWindow(e.authorize_url,{onUrlChange:i,onClose:s,ui:{}})},this.handleError("flickr.sharing.getAuthorizeUrl"))},post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this,s;e.halt(),r[this.get("modelName")+"_id"]=this.get("model").id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1");try{s=o.escapeInput(this.accountDd.selected,"numericstring"),s||(s=this.get("networks").twitter.accounts[0].id)}catch(a){return this.handleError("flickr.sharing.post")("Twitter account not found on posting")}return r.service_id=s,r.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO TWITTER",r),t.addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),i.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,e)))},composeSignedOut:function(){var e,t;e={url:document.location.href},u.debug&&(e.url=e.url.replace("local.flickr.com","www.flickr.com")),o.log("ANON POST TO TWITTER",e),this.get("container").addClass(u.css.working),t=o.buildHttpQuery(u.networks.twitter.signedOutShareUrl,e),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(t)},destructor:function(){this
.accountDd=null,n.Connect.prototype.destroy.call(this)}}),n.ConnectTwitter.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-twitter"},serviceType:{value:"9"},serviceName:{value:"Twitter"}}),n.ConnectTumblr=function(){this._class="ConnectTumblr",r.apply(this,arguments)},e.extend(n.ConnectTumblr,r,{render:function(){r.prototype.render.call(this),this.publishingDd=new s(this.get("container").one('[data-field="publishing"]')),this.accountDd=new s(this.get("container").one('[data-field="account"]'))},authorize:n.ConnectTwitter.prototype.authorize,post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this,s;e.halt(),r[this.get("modelName")+"_id"]=this.get("model").id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1");try{s=o.escapeInput(this.accountDd.selected,"numericstring"),s||(s=this.get("networks").tumblr.accounts[0].id)}catch(a){return this.handleError("flickr.sharing.post")("Tumblr account not found on posting")}return r.service_id=s,r.status=o.constrainToValues(this.publishingDd.selected,["publish","queue","draft"]),r.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO TUMBLR",r),t.addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),i.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,e)))},composeSignedOut:function(){var t=this.get("model"),n=t.getValue("sizes"),r,i,s=t.getValue("owner").getValue("url"),a=document.location.href,f,l,c;r=n[u.networks.blogger.shareSize],r||(r=t.getLargestSize(t.getValue("id"))),u.debug&&(a=a.replace("local.flickr.com","www.flickr.com")),i=this.appContext.flipper.isFlipped("https_everything")?"https":"http",s=i+"://www.flickr.com"+s,r=n[u.networks.tumblr.shareSize],r||(r=t.getLargestSize(t.getValue("id"))),f=this.templates("share-link-tumblr")(e.merge(this.toJSON(),{imgSize:r,pageUrl:a,ownerUrl:s})),l={source:(this.appContext.flipper.isFlipped("https_everything")?"https:":"http:")+r.url,caption:f,click_thru:a},o.log("ANON POST TO TUMBLR",l),c=o.buildHttpQuery(u.networks.tumblr.signedOutShareUrl,l),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(c)},destructor:function(){this.publishingDd=null,this.accountDd=null,n.Connect.prototype.destroy.call(this)}}),n.ConnectTumblr.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-tumblr"},serviceType:{value:"12"},serviceName:{value:"Tumblr"}}),n.ConnectPinterest=function(){this._class="ConnectPinterest",r.apply(this,arguments)},e.extend(n.ConnectPinterest,r,{render:function(e){},show:function(){},hide:function(){},activate:function(){this.post()},post:function(){var e,t,n=this.get("model"),r=n.getValue("sizes"),i=n.getValue("title")||u.networks.pinterest.defaultDescription,s;s=r[u.networks.pinterest.shareSize],s||(s=n.getLargestSize(n.getValue("id"))),e={url:document.location.href,description:i,media:(this.appContext.flipper.isFlipped("https_everything")?"https:":"http:")+s.url},t=o.buildHttpQuery(u.networks.pinterest.signedOutShareUrl,e),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(t,{onClose:function(){},ui:{}}),this.fire("dismissed")},composeSignedOut:function(){this.post()}}),n.ConnectPinterest.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-pinterest"},serviceType:{value:"999"},serviceName:{value:"Pinterest"}}),n.ConnectBlogger=function(){this._class="ConnectBlogger",r.apply(this,arguments)},e.extend(n.ConnectBlogger,r,{post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r=t.one('[data-field="account"]'),i={},s=this;return e.halt(),i[this.get("modelName")+"_id"]=this.get("model").id,i.service_type_id=this.get("serviceType"),this.isPrivate()&&(i.guestpass_private="1"),r&&(i.service_id=o.escapeInput(r.get("value"),"numericstring")),i.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO BLOGGER",i),this.get("container").addClass(u.css.working),this.api.callMethod("flickr.sharing.post",i).then(function(e){s.get("container").removeClass(u.css.working),s.fire("posted")},this.handleError("flickr.sharing.post",this.handleRetry(this.post,e)))},composeSignedOut:function(){var t=this.get("model"),n=t.getValue("sizes"),r,i,s=t.getValue("owner").getValue("url"),a=document.location.href,f,l,c;r=n[u.networks.blogger.shareSize],r||(r=t.getLargestSize(t.getValue("id"))),i=this.appContext.flipper.isFlipped("https_everything")?"https":"http",s=i+"://www.flickr.com"+s,u.debug&&(a=a.replace("local.flickr.com","www.flickr.com")),f=this.templates("share-link-blogger")(e.merge(this.toJSON(),{imgSize:r,pageUrl:a,ownerUrl:s})),l={n:this.get("model").getValue("title"),b:f},o.log("ANON POST TO BLOGGER",l),this.get("container").addClass(u.css.working),c=o.buildHttpQuery(u.networks.blogger.signedOutShareUrl,l),this._shareWin&&this._shareWin.close(),this._shareWin=o.openPopupWindow(c)},authorize:function(e){console.warn("Blogger integration uses a test API id! not for production!!!");var t,n,r=this,i;t={client_id:u.networks.blogger.clientId,redirect_uri:u.shareRedirectURL,response_type:"token",scope:u.networks.blogger.scope},n=o.buildHttpQuery(u.networks.blogger.authorizeUrl,t),i=function(){var t=r._oauthWin.location.hash||"",n;n=t.slice(1).split(/&/).reduce(function(e,t){var n=t.split(/=/);return e[n[0]||"_empty_"]=n[1],e},{}),n.access_token&&(r._oauthWin.close(),e({token:n.access_token,expiresIn:(parseInt(n.expires_in,10)||0)*1e3}))},this._oauthWin&&this._oauthWin.close(),this._oauthWin=o.openPopupWindow(n,{onUrlChange:i,ui:{}})}}),n.ConnectBlogger.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-blogger"},serviceType:{value:"3"},serviceName:{value:"Blogger"}}),n.ConnectMail=function(){this._class="ConnectMail",r.apply(this,arguments)},e.extend(n.ConnectMail,r,{activate:function(){var e=this;r.prototype.activate.call(this),this.get("container").addClass(u.css.locked),this.contacts=new i({el:this.get("container").one('[data-field="recipient"]'),appContext:this.appContext,shim:u.css
.shim,signedOut:this.get("signedOut"),onError:this.handleError("ContactSearchBox"),onShow:function(t){e.get("container").addClass(u.css.locked)},onSelect:function(t){t?e.get("container").removeClass(u.css.locked):e.get("container").addClass(u.css.locked)}})},post:function(e){var t=this.get("container"),n=t.one('[data-field="message"]'),r={},i=this.get("model"),s=this;e.halt();if(!this.contacts.selected)return;return r[this.get("modelName")+"_id"]=i.id,r.service_type_id=this.get("serviceType"),this.isPrivate()&&(r.guestpass_private="1"),this.contacts.selected.nsid?r.to_flickr=this.contacts.selected.nsid:this.contacts.selected.email&&(r.to_email=this.contacts.selected.email),r.message=o.escapeInput(n.get("value"),"text"),o.log("POST TO MAIL",r),this.get("container").addClass(u.css.working),this.api.callMethod("flickr.sharing.post",r).then(function(e){t.removeClass(u.css.working),s.fire("posted")},this.handleError("flickr.sharing.post"))},composeSignedOut:function(){function s(){n&&n.destroy(),e.SigninHelper.addPendingShare({shareType:"email"})}var t,n,r,i;i=this.appContext,this.parent.hide(),t=new e.Views["confirmation-dialog-view"]({title:"Sign in",icon:"ui-icon-big-error",heading:"Just a second!",content:"You must be signed in to email a photo. You will be redirected to signin now.",confirmButtonLabel:"Sign in",cancelButtonLabel:"Forget it",appContext:i}),t.render(),t.activate(),n=e.Views.dialog.getNewInstance("dialog-modal",{content:t.get("container"),appContext:i}),n.show(),r=setTimeout(s,5e3),t.registerEventHandler(t.get("container").one(".ui-dialog-button-confirm").on("click",s),t.get("container").one(".ui-dialog-button-cancel").on("click",function(){clearTimeout(r)})),n.registerEventHandler(n.on("dismiss",function(e){clearTimeout(r)}))},handleError:function(e,t){var n=this;return function(t){n.parent.handleError(n._class+":"+e)(t)}}}),n.ConnectMail.ATTRS=e.merge(r.ATTRS,{template:{value:"share-modal-mail"},serviceType:{value:"130"},serviceName:{value:"Email"}}),i=e.ContactSearchBox,s=function(e,t){this.options=t,this._items=[],this.el=e,this.containerEl=null,this.listEl=null,this.labelEl=null,this.selected=null,this._open=!0,this._handlers=[],this._init()},s.prototype={_init:function(){if(!this.el)return;this._render(),this._handlers=[this.containerEl.delegate("click",this._onClick,"span, li",this)]},_render:function(){var t=this.el.getDOMNode(),n,r,i,s;s="ui-dropdown "+this.el.getDOMNode().className,this.containerEl=e.Node.create('<div class="'+s+'"/>'),this.listEl=n=e.Node.create("<ul/>"),this.labelEl=e.Node.create("<span/>"),this._items=r={},Array.prototype.slice.call(t.options).forEach(function(t){var i,s;i=r[t.value]={value:t.value,label:t.text},s=e.Node.create("<li/>"),s.set("text",i.label),s.setAttribute("data-value",i.value),n.appendChild(s)}),this.containerEl.appendChild(this.labelEl),this.containerEl.appendChild(this.listEl),this.el.setStyle("display","none"),this.el.insert(this.containerEl,"before"),i=t.options[t.selectedIndex]||{},this.select(i.value)},_onClick:function(e){var t=e.target,n=t.get("tagName").toLowerCase();if(n==="li")return this.select(t.getData("value"));if(n==="span")return this.toggle()},select:function(e){this.selected=e||null,this.labelEl.set("text",this.selected?this._items[this.selected].label:"..."),this.close()},open:function(){this._open=!0,this.listEl.setStyle("display","block")},close:function(){this._open=!1,this.listEl.setStyle("display","none")},toggle:function(){this[this._open?"close":"open"]()},destructor:function(){this._handlers.forEach(function(e){e.detach()}),this._handlers=null,this._items=null,this.el=null,this.containerEl=null,this.listEl=null,this.labelEl=null,this.selected=null}}},"@VERSION@",{requires:["flutil","dialog","dropdown","charmtabs","flickr-promise","contact-search-box","hermes-template-share","hermes-template-share-modal-facebook","hermes-template-share-modal-twitter","hermes-template-share-modal-mail","hermes-template-share-modal-tumblr","hermes-template-share-modal-blogger","hermes-template-share-link-tumblr","hermes-template-share-link-blogger"],optional:["photo-models","photostream-models","share-css"]});
YUI.add("hermes-template-fave",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){return"is-faved"}function h(e,t){return"can-not-fave"}function p(e,t){var r,i;return i={hash:{},data:t},f((r=n.formatNumber||e.formatNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.faveCount),i):a.call(e,"formatNumber",(r=e.photo,r==null||r===!1?r:r.faveCount),i)))}function d(e,t){var r,i;return i=n["if"].call(e,(r=e.photo,r==null||r===!1?r:r.faveCount),{hash:{},inverse:l.noop,fn:l.program(8,v,t),data:t}),i||i===0?i:""}function v(e,t){var r,i;return i={hash:{},data:t},f((r=n.friendlyNumber||e.friendlyNumber,r?r.call(e,(r=e.photo,r==null||r===!1?r:r.faveCount),i):a.call(e,"friendlyNumber",(r=e.photo,r==null||r===!1?r:r.faveCount),i)))}function m(e,t){var r="",i;r+='\n		    <a href="#" title="',i=n["if"].call(e,e.loadingView,{hash:{},inverse:l.program(13,y,t),fn:l.program(11,g,t),data:t});if(i||i===0)r+=i;return r+='" data-action="fave"></a>\n		',r}function g(e,t){return"Loading Faves..."}function y(e,t){var r="",i,s;s=n["if"].call(e,(i=e.photo,i==null||i===!1?i:i.isFaved),{hash:{},inverse:l.program(16,w,t),fn:l.program(14,b,t),data:t});if(s||s===0)r+=s;return r+=" this photo",r}function b(e,t){return"Unfave"}function w(e,t){return"Fave"}function E(e,t){return'\n		    <a href="#" title="Who faved this photo" data-action="showfaves"></a>\n		'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression,l=this;s+='<div class="button">\n	<span class="hide-text fave-star ',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.isFaved),{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(u||u===0)s+=u;s+=" ",u=n.unless.call(t,(o=t.photo,o==null||o===!1?o:o.canFave),{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(u||u===0)s+=u;s+='">&9733;</span>\n	<span class="fave-count" unselectable="on">',u=n["if"].call(t,t.realFullscreen,{hash:{},inverse:l.program(7,d,i),fn:l.program(5,p,i),data:i});if(u||u===0)s+=u;s+='</span>\n\n	<div class="button-overlay">\n	    ',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.canFave),{hash:{},inverse:l.noop,fn:l.program(10,m,i),data:i});if(u||u===0)s+=u;s+="\n		",u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.faveCount),{hash:{},inverse:l.noop,fn:l.program(18,E,i),data:i});if(u||u===0)s+=u;return s+="\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fave",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
