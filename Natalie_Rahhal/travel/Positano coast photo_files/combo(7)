YUI.add("hermes-template-dialog-tooltip",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){return" ui-dialog-tooltip-witharrow"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression;s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-tooltip',u=n["if"].call(t,(o=t.attrs,o==null||o===!1?o:o.arrow),{hash:{},inverse:f.noop,fn:f.program(1,h,i),data:i});if(u||u===0)s+=u;return s+='" data-action="halt">\n	<span class="ui-dialog-arrow"></span>\n	<div class="ui-dialog-body">\n	',a={hash:{},data:i},s+=c((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,a):l.call(t,"dialogOutlet",t.content,a)))+"\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-tooltip",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-modal">\n	<div class="ui-dialog-body">\n	',u={hash:{},data:i},s+=f((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,u):a.call(t,"dialogOutlet",t.content,u)))+"\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-modal",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-alert",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-alert">\n	<div class="ui-dialog-gutter ui-dialog-alert-icon-'+f((o=(o=t.attrs,o==null||o===!1?o:o.level),typeof o===a?o.apply(t):o))+'" data-action="dismiss"></div>\n	<div class="ui-dialog-body" data-action="dismiss">\n		',u={hash:{},data:i},s+=f((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,u):l.call(t,"dialogOutlet",t.content,u)))+"\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-alert",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-dialog-cta",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"ui-buttonbar-vertical"}function d(e,t){var n="",r;return n+='\n				<button class="ui-button ui-button-cta" data-action="confirm"><span>'+l((r=(r=e.attrs,r==null||r===!1?r:r.confirmButtonText),typeof r===f?r.apply(e):r))+"</span></button>\n			",n}function v(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.buttonMarkup,{hash:{},inverse:c.program(8,g,t),fn:c.program(6,m,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function m(e,t){var n="",r;return n+="\n					"+l((r=e.buttonMarkup,typeof r===f?r.apply(e):r))+"\n				",n}function g(e,t){var r="",i;r+='\n					<button class="ui-button" ',i=n["if"].call(e,e.buttonAction,{hash:{},inverse:c.noop,fn:c.program(9,y,t),data:t});if(i||i===0)r+=i;return r+="><span>"+l((i=e.buttonLabel,typeof i===f?i.apply(e):i))+"</span></button>\n				",r}function y(e,t){var n="",r;return n+='data-action="'+l((r=e.buttonAction,typeof r===f?r.apply(e):r))+'"',n}function b(e,t){var n="",r;return n+='\n				<button class="ui-button" data-action="decline"><span>'+l((r=(r=e.attrs,r==null||r===!1?r:r.cancelButtonText),typeof r===f?r.apply(e):r))+"</span></button>\n			",n}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;s+='<div class="ui-dialog-wrapper ui-dialog ui-dialog-cta">\n	<h1 class="ui-dialog-title">'+l((o=(o=t.attrs,o==null||o===!1?o:o.title),typeof o===f?o.apply(t):o))+'</h1>\n	<div class="ui-dialog-body">\n		<div class="ui-util-paragraph">\n			',a={hash:{},data:i},s+=l((o=n.dialogOutlet||t.dialogOutlet,o?o.call(t,t.content,a):h.call(t,"dialogOutlet",t.content,a)))+'\n		</div>\n		<div class="ui-buttonbar ',u=n["if"].call(t,(o=t.attrs,o==null||o===!1?o:o.verticalButtonList),{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(u||u===0)s+=u;s+='">\n			',u=n.unless.call(t,(o=t.attrs,o==null||o===!1?o:o.hideConfirmButton),{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n			\n			",u=n.each.call(t,(o=t.attrs,o==null||o===!1?o:o.additionalButtons),{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n			\n			",u=n["if"].call(t,(o=t.attrs,o==null||o===!1?o:o.useCancelButton),{hash:{},inverse:c.noop,fn:c.program(11,b,i),data:i});if(u||u===0)s+=u;return s+="\n		</div>\n	</div>\n</div>\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/dialog-cta",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("dialog",function(e){"use strict";var t,n,r={},i=e.config.win,s=e.config.doc;t={css:{state:"c-state-{{state}}",hidden:"ui-util-hidden",loading:"ui-util-loading",working:"ui-util-working",locked:"ui-util-locked",complete:"ui-util-complete",removed:"ui-util-removed",content:"js-content",wrapper:"ui-dialog-wrapper",anchorSelected:"ui-util-selected",curtain:"ui-dialog-modal-curtain",curtainClear:"ui-dialog-modal-curtain-clear",arrow:"ui-dialog-arrow"},transitionTimeout:2e3,debug:!1},n=e.merge(e.flutil,{log:function(){if(!t.debug||!console.log.apply)return;var e=[].slice.call(arguments);e.unshift("DIALOG"),n.dump.apply(null,e)},propagateWrapperAttributes:function(e,n){var r=[],i;return n?(Array.prototype.slice.call(n.getDOMNode().classList).forEach(function(i){if(i===t.css.wrapper)return;n.removeClass(i),e.addClass(i),r.push(i)}),i=n.getAttribute("data-action"),i&&(n.removeAttribute("data-action"),r.push({attr:"data-action",restore:e.getAttribute("data-action")||null}),e.setAttribute("data-action",i)),r):r},rollbackWrapperAttributes:function(e,t){if(!t)return;for(var n=0,r=t.length;n<r;n++)typeof t[n]=="object"?t[1].restore?e.setAttribute(t[n].name,t[n].restore):e.removeAttribute(t[n].name):e.removeClass(t[n])}}),e.namespace("Views").dialog={_dialogs:{},getInstance:function(t,r){var i,s,o;return r.id?s={id:r.id}:(s=e.merge(r),delete s.parent,delete s.rootEl,delete s.template,typeof s.content=="object"&&s.content instanceof e.FlickrView?s.content=s.content.get("container").toString():typeof s.content=="function"?s.content=s.content({}):s.content.toString()),i="SGL"+n.createHashCode(s),o=this._dialogs[t+":"+i],o?o:this._new(t,i,r)},getNewInstance:function(e,t){var n="OBJ"+(Object.keys(this._dialogs).length+1)+(new Date).getTime();return this._new(e,n,t)},_new:function(t,n,i){var s,o,u,a,f;if(e.Env.isServer)throw new Error("Dialogs are client-only!");i=e.mix(i||{});if(i.parent)o=i.parent,delete i.parent,a=o.getContainer({subviewName:t,subviewParams:i}),u=o.appContext;else{if(!i.appContext)throw new Error('Either the "appContext" or "parent" parameter is required!');o=null,u=i.appContext,a=e.Node.create("<div/>"),a.addClass("view").addClass(t)}return i.appContext=u,i.container=a,s=new r[t](i),f=t+(n?":"+n:""),this.registerView(s,f),this._navigateCloseHook||(this._navigateCloseHook=u.flapp.on("navigate",this.close.bind(this))),s},registerView:function(e,t){var n=this;t=t||"REG"+(Object.keys(this._dialogs).length+1),e.manager=this,this._dialogs[t]=e,e.on("destroy",function(){delete n._dialogs[t]})},hide:function(e){this.close(e,"hide")},close:function(e,t){var n=this,r;t=t||"close",typeof e=="string"?r=function(r){if(e!==r.split(/:/)[0])return;n._dialogs[r][t]()}:typeof e=="object"?r=function(r){if(e===n._dialogs[r])return;n._dialogs[r][t]()}:r=function(e){n._dialogs[e][t]()},Object.keys(this._dialogs).forEach(r)},isOpen:function(e){},util:n},e.namespace("Views").dialogs=r,r["dialog-base"]=e.Base.create("dialog-base",e.FlickrView,[],{initializer:function(e){return e=e||{},this.state={},this.manager=null,this.appContext=this.appContext||e.appContext,this},render:function(){var n=this.templates(this.get("template"))(this.toJSON());return this.setContainerHTML(n),e.namespace("Views").dialog.util.propagateWrapperAttributes(this.get("container"),this.get("container").one("."+t.css.wrapper)),this.renderContent(),this.activate(),this.get("container").addClass(t.css.hidden),this.anchorToLayout(),this.state.visible=!0,this.hide(),this.state.rendered=!0,this.fire("rendered"),this},renderContent:function(){var r=this.get("content"),i=this.get("container"),s=i.one("."+t.css.content);e.namespace("Views").dialog.util.rollbackWrapperAttributes(this.get("container"),this._contWrap);if(r instanceof e.FlickrView){r=r.get("container");if(!r)throw new Error("The Content View doesn't have a container");s.setHTML(""),s.appendChild(r)}else r instanceof e.Node?(s.setHTML(""),s.appendChild(r)):typeof r=="function"?(r=r(this.toJSON()),s.setHTML(r)):typeof r=="string"&&this.state.rendered&&s.setHTML(r);this._contWrap=n.propagateWrapperAttributes(i,s.one("."+t.css.wrapper))},renderCurtain:function(){var n=this,r;this.get("curtain")||(r=e.Node.create("<div/>"),r.addClass(t.css.curtain).addClass(t.css.hidden),this.get("visibleShim")||r.addClass(t.css.curtainClear),r.on("click",this.dismiss,this),this.set("curtain",r),this.get("appendCurtainTo")?this.get("appendCurtainTo").appendChild(r):this.get("container").ancestor().insert(r,"after")),n.get("curtain").removeClass(t.css.hidden)},anchorToLayout:function(){var e=this.get("container"),t=this.get("anchorTo");(this.get("appendTo")||t||this.get("rootEl")).appendChild(e),this.get("positioning")&&this.refreshPosition()},refreshPosition:function(){var n,r,s,o,u,a,f,l,c=this.get("container"),h=this.get("anchorTo"),p;o=c.getDOMNode().getBoundingClientRect(),this.set("width",o.width),this.set("height",o.height),c.getComputedStyle("position")==="fixed"&&c.setStyles({marginLeft:(-1*o.width/2|0)+"px",marginTop:(-1*o.height/2|0)+"px",width:o.width+"px",height:o.height+"px"});if(h){n=h.getDOMNode().getBoundingClientRect(),this.set("anchorWidth",n.width),this.set("anchorHeight",n.height),l={width:i.innerWidth,height:i.innerHeight},u=[[n.bottom+o.height<l.height&&n.right+o.width<l.width,{left:0,top:n.height},"topleft"],[n.bottom+o.height<l.height&&n.left-o.width>0,{right:0,top:n.height},"topright"],[n.top>o.height&&n.right+o.width<l.width,{left:0,bottom:n.height},"bottomleft"],[n.top>o.height&&n.left-o.width>0,{right:0,bottom:n.height},"bottomright"],[!0,{left:-1*o.width/2|0,top:0}]];while(u.length){f=u.shift();if(f[0]){a=f[1],c.addClass("ui-dialog-tooltip-witharrow-"+f[2]),c.setStyles(e.mix({top:"auto",bottom:"auto",left:"auto",right:"auto"},a,!0));break}}p=c.one("."+t.css.arrow),p&&(r=20,s=Math.round((n.width-r)/2)+"px",p.setStyles({right:a.right===undefined?"auto":s,left:a.left===undefined?"auto":s}))}},activate:function(){var e={":confirm":this.confirm,":decline":this.decline,":dismiss"
:this.dismiss,":halt":function(e){e.halt()}};return this.attachEvents(e),this},toJSON:function(){var t=this.getAttrs();return Object.keys(t).reduce(function(n,r){var i=t[r];return i instanceof e.Node?n:i instanceof e.FlickrView?n:(i&&i.toJSON&&(i=i.toJSON()),n[r]=i,n)},{})},isVisible:function(){return!!this.state.visible},isLocked:function(){return!!this.state.locked},isWorking:function(){return!!this.state.working},show:function(r){var i=this,s=this.get("container"),o=this.get("anchorTo");this.switchToLoading(!1);if(this.state.visible)return;this.state.rendered||this.render(),i.state.visible=!0,this.fire("show"),s.removeClass(t.css.removed),setTimeout(function(){n.onTransitionEnd(s,r),s.removeClass(t.css.hidden),o&&o.addClass(t.css.anchorSelected)},10),e.fire("flickr:setKeyEventScope",this.getKeyEventScope())},handleError:function(e){return function(t){console.error(e,!t.toString||t.toString().match(/^\[object/)?t:t.toString())}},getKeyEventScope:function(){return this.name+this._yuid},close:function(e){if(this._destroyed)return;var t=this;this.fire("close"),this.hide(function(){t.destructor(),e&&e()})},destructor:function(){var t=this.get("container");t.detach(),t.remove(),this.set("container",null),this.set("content",null),this.set("appendTo",null),this.set("anchorTo",null),this.set("rootEl",null),this.manager=null,e.FlickrView.prototype.destroy.call(this),this._destroyed=!0,this.fire("destroy"),this.detachAll()},hide:function(r){e.fire("flickr:removeKeyEventScope",this.getKeyEventScope());if(!this.state.visible)return;var i=this,s=this.get("container"),o=this.get("anchorTo"),u=this.get("curtain"),a=!this.state.rendered;this.state.visible=!1,o&&o.removeClass(t.css.anchorSelected),u?(this.set("curtain",null),u.detach(),n.onTransitionEnd(u,function(){u.remove()}),u.addClass(t.css.hidden)):s.addClass(t.css.removed),e.namespace("Views").dialog.util.onTransitionEnd(s,function(){a||i.fire("hide"),i.state.visible||s.addClass(t.css.removed),r&&r()}),s.addClass(t.css.hidden)},toggle:function(e){this[this.state.visible?"hide":"show"](e),this.fire("toggle",this.state.visible)},switchToLoading:function(e){this.switchToUIState("loading",e)},switchToComplete:function(e){this.switchToUIState("complete",e)},switchToLocked:function(e){this.switchToUIState("locked",e)},switchToWorking:function(e){this.switchToUIState("working",e)},switchToUIState:function(e,n){var r;n=n===!1?!1:!0;if(this.state[e]===n)return;n&&this.show(),this.state[e]=n,r=t.css[e]||t.css.state.replace(/\{\{state\}\}/,e),this.get("container")[n?"addClass":"removeClass"](r)},confirm:function(t,n){t.halt(),this.fire("confirm",n),this.get("hideOnButtonClick")&&this.hide(),e.namespace("Views").dialog.util.log("CONFIRM")},decline:function(t,n){t.halt(),this.fire("decline",n),this.get("hideOnButtonClick")&&this.hide(),e.namespace("Views").dialog.util.log("DECLINE")},dismiss:function(t,n){if(this.isWorking()||!this.get("hideOnCurtainClick"))if(t.target===this.get("curtain"))return;t.halt(),this.fire("dismiss",n),this.hide(),e.namespace("Views").dialog.util.log("DISMISS")}},{ATTRS:{template:{value:"dialog"},anchorTo:{value:null},appendTo:{value:null},appendCurtainTo:{value:null},rootEl:{value:e.Node&&e.one(s&&s.body)},content:{value:null},attrs:{value:{}},stack:{value:!1},hideOnButtonClick:{value:!0},hideOnCurtainClick:{value:!0},visibleShim:{value:!0},positioning:{value:!0}}}),r["dialog-tooltip"]=e.Base.create("dialog-tooltip",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-tooltip"},visibleShim:{value:!1}}}),r["dialog-modal"]=e.Base.create("dialog-modal",r["dialog-base"],[],{anchorToLayout:function(){this.set("anchorTo",null),r["dialog-base"].prototype.anchorToLayout.apply(this,arguments)},show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-modal"}}}),r["dialog-alert"]=e.Base.create("dialog-alert",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()}},{ATTRS:{template:{value:"dialog-alert"},visibleShim:{value:!1}}}),r["dialog-cta"]=e.Base.create("dialog-cta",r["dialog-base"],[],{show:function(){this.get("stack")||this.manager.close(this),r["dialog-base"].prototype.show.apply(this,arguments),this.renderCurtain()},hide:function(){this.get("curtain")&&(this.get("curtain").remove(),this.set("curtain",null)),r["dialog-base"].prototype.hide.apply(this,arguments)}},{ATTRS:{template:{value:"dialog-cta"},visibleShim:{value:!1}}}),r["dialog-progress"]=e.Base.create("dialog-progress",r["dialog-base"],[],{},{ATTRS:{template:{value:"dialog-progress"}}}),e.Handlebars.registerHelper("dialogOutlet",function(n){var r=['<div class="'+t.css.content+'">'];return n instanceof e.FlickrView||n instanceof e.Node?r.push("<!--"+(n.name||"DOM-node")+"-->"):r.push((n||"")+""),r.push("</div>"),new e.Handlebars.SafeString(r.join(""))})},"@VERSION@",{requires:["flickr-view","handlebars-base","flutil","hermes-template-dialog-tooltip","hermes-template-dialog-modal","hermes-template-dialog-alert","hermes-template-dialog-cta","flickrui-css"]});
YUI.add("overflow-helper",function(e){function t(t){var n=0,r;return YUI.Env.isServer||(r=e.Node.create("<div></div>"),r.setStyle("width",100).setStyle("height",100).setStyle("overflow","scroll").setStyle("position","absolute").setStyle("top",-9999),t.append(r),n=r._node.offsetWidth-r._node.clientWidth,r.remove(!0)),n}function n(t,n){var r,i,s;YUI.Env.isServer||(r=e.Node.create("<div>test event</div>"),r.setStyle("height: 1px").setStyle("width","1px").setStyle("opacity",0).setStyle("position","absolute").setStyle("top",-99999).setStyle("left",-99999).setStyle("overflow","auto"),t.append(r),i=setTimeout(function(){r._node.removeEventListener("overflow",s),r.remove(!0),n(!1)},10),s=function(e){clearTimeout(i),r._node.removeEventListener("overflow",s),r.remove(!0),n(!0)},r._node.addEventListener("overflow",s,!1))}function r(e,t,r,i){var s=t==="over",o,u,a,f;"OverflowEvent"in window?(f=function(e){if(e.type===t+"flow"||e.orient===0&&e.horizontalOverflow===s||e.orient===1&&e.verticalOverflow===s||e.orient===2&&e.horizontalOverflow===s&&e.verticalOverflow===s)return r.call(this,e)},a=e._node.addEventListener("overflowchanged",f,!1),i({detach:function(){e._node.removeEventListener("overflowchanged",f)}})):n(e,function(n){n?(f=function(e){if(e.type===t+"flow"||e.orient===0&&e.horizontalOverflow===s||e.orient===1&&e.verticalOverflow===s||e.orient===2&&e.horizontalOverflow===s&&e.verticalOverflow===s)return r.call(this,e)},a=e._node.addEventListener(t+"flow",f,!1),i({detach:function(){e._node.removeEventListener(t+"flow",f)}})):(u=function(){e._node.scrollHeight>e._node.clientHeight?t==="over"&&r.call(e._node,{}):t==="under"&&r.call(e._node,{})},"MutationObserver"in window?(o=new MutationObserver(function(e){e.some(function(e){return u(),!0})}),o.observe(e._node,{attributes:!1,subtree:!0,childList:!0}),i({detach:function(){o.disconnect()}})):"MutationEvent"in window&&(f=function(e){setTimeout(function(){u()},10)},a=e._node.addEventListener("DOMSubtreeModified",f,!1),i({detach:function(){e._node.removeEventListener("DOMSubtreeModified",f)}})))})}e.OverflowHelper={detectScrollbarSize:t,addFlowListener:r}},"@VERSION@",{requires:[]});
YUI.add("hermes-template-reboot-welcome-dialog-content",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function a(e,t){return"\n	While we continue to develop the beta experience, we want your feedback. In case you need some of the missing functionality, you can easily opt-out and go back to the old experience.\n"}function f(e,t){return"\n	Please continue providing us with feedback so we can continue to improve Flickr.\n"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this;s+="Flickr is about the amazing photos you capture and the communities that you build around these photos. The goal of our photo page redesign is to provide you with a fast photo browsing experience and an easy interface to build &amp; maintain relationships.<br>\n<br>\nOver the last 4 weeks, we received a lot of feedback from the Flickr community regarding the photo page design. Based on the feedback, we are experimenting with different variations of the photo page to identify the best experience.<br>\n<br>\n",o=n["if"].call(t,t["opt-out-enabled"],{hash:{},inverse:u.program(3,f,i),fn:u.program(1,a,i),data:i});if(o||o===0)s+=o;return s+="\n<br>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/reboot-welcome-dialog-content",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-opt-out",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='<form action="http://www.flickr.com/help/optin" method="post">\n	<input type="hidden" name="photo_opt" value="0">\n	<input type="hidden" name="redirect_url" value="',(o=n["redirect-url"])?o=o.call(t,{hash:{},data:i}):(o=t["redirect-url"],o=typeof o===u?o.apply(t):o),s+=a(o)+'">\n	<input type="submit" class="ui-button" value="Go back to the old experience">\n</form>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-opt-out",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-keyboard-legend",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return'\n\n<div class="keyboard-shortcut-legend all-layout">\n	<ul class="keyboard-row">\n		<li class="key-size-0 key0">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">F</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Fave</span>\n		</li>\n		<li class="key-size-0 key1">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">C</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Comment</span>\n		</li>\n		<li class="key-size-0 key2">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">S</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Share</span>\n		</li>\n		<li class="key-size-0 key3">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">&lt;</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Prev</span>\n		</li>\n		<li class="key-size-0 key4">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">&gt;</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Next</span>\n		</li>\n		<li class="key-size-0 key5">\n			<span class="key-container">\n				<a href="#" class="key-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">esc</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Close</span>\n		</li>\n		<li class="key-size-0 key6">\n			<span class="key-container">\n				<a href="#" class="key-height half-height" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">?</span>\n						<span class="sub">/</span>\n					</span>\n				</a>\n			</span>\n			<span class="shortcut-label">Shortcut dialog</span>\n		</li>\n	</ul>\n</div>\n<div class="show-legend">\n	<a href="#" class="show-legend-link">More</a>\n</div>\n\n'}function d(e,t){var r="",i;r+='\n\n<div class="keyboard-shortcut-legend ',(i=n.type)?i=i.call(e,{hash:{},data:t}):(i=e.type,i=typeof i===f?i.apply(e):i),r+=l(i)+'-layout">\n	<p class="keyboard-legend-title">Keyboard Shortcuts</p>\n	\n	',i=n.each.call(e,e.rows,{hash:{},inverse:c.noop,fn:c.program(4,v,t),data:t});if(i||i===0)r+=i;return r+="\n\n	\n</div>\n\n",r}function v(e,t){var r="",i;r+='\n	<ul class="keyboard-row">\n		',i=n.each.call(e,e.keys,{hash:{},inverse:c.noop,fn:c.program(5,m,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n	",r}function m(e,t){var r="",i;r+='\n		<li class="key-size-',i=n["if"].call(e,e.keySize,{hash:{},inverse:c.program(8,y,t),fn:c.program(6,g,t),data:t});if(i||i===0)r+=i;r+=" ",(i=n.keyId)?i=i.call(e,{hash:{},data:t}):(i=e.keyId,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n			',i=n["if"].call(e,e.label,{hash:{},inverse:c.program(15,S,t),fn:c.program(10,b,t),data:t});if(i||i===0)r+=i;return r+="\n		</li>\n		",r}function g(e,t){var r;return(r=n.keySize)?r=r.call(e,{hash:{},data:t}):(r=e.keySize,r=typeof r===f?r.apply(e):r),l(r)}function y(e,t){return"0"}function b(e,t){var r="",i;r+='\n			<span class="key-container highlight">\n				<a href="#" class="key-height ',i=n["if"].call(e,e.label2,{hash:{},inverse:c.noop,fn:c.program(11,w,t),data:t});if(i||i===0)r+=i;r+='" role="button" tabindex="-1">\n					<span class="key">\n						<span class="sub">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n						",i=n["if"].call(e,e.label2,{hash:{},inverse:c.noop,fn:c.program(13,E,t),data:t});if(i||i===0)r+=i;return r+="\n					</span>\n				</a>\n			</span>\n			",r}function w(e,t){return"half-height"}function E(e,t){var r="",i;return r+='\n						<span class="sub">',(i=n.label2)?i=i.call(e,{hash:{},data:t}):(i=e.label2,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n						",r}function S(e,t){return'\n			<span class="key-container"></span>\n			'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=this,h=n.helperMissing;a={hash:{},inverse:c.program(3,d,i),fn:c.program(1,p,i),data:i},u=(o=n.ifCond||t.ifCond,o?o.call(t,t.type,"===","short",a):h.call(t,"ifCond",t.type,"===","short",a));if(u||u===0)s+=u;return s+="\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/keyboard-legend",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-html5-balls",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'\n<div class="html5-balls">\n	<div class="blueball"></div>\n	<div class="pinkball"></div>\n</div>\n'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html5-balls",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-html4-balls",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{},'\n<div class="html4-balls"></div>\n'}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html4-balls",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("html5-balls",function(e){var t=!(e.UA.ie&&e.UA.ie<9),n;n=function(e){return t?"html5-balls":"html4-balls"},e.augment(n,e.Attribute),e.Balls=n},"@VERSION@",{requires:["base","html5-balls-css","hermes-template-html5-balls","hermes-template-html4-balls","handlebars-helpers","template-base"]});
YUI.add("keyboard-legend-view",function(e){var t={qwerty:[{keys:[{keyId:"key0",label:"esc"}]},{keys:[{keyId:"key1"},{keyId:"key2"},{keyId:"key3"},{keyId:"key4"},{keyId:"key5"},{keyId:"key6"},{keyId:"key7"},{keyId:"key8"},{keyId:"key9"},{keyId:"key10"},{keyId:"key11"},{keyId:"key12"},{keyId:"key13"},{keyId:"key14",keySize:1}]},{keys:[{keyId:"key15",keySize:1},{keyId:"key16"},{keyId:"key17"},{keyId:"key18",label:"E"},{keyId:"key19"},{keyId:"key20",label:"T"},{keyId:"key21"},{keyId:"key22"},{keyId:"key23"},{keyId:"key24"},{keyId:"key25",label:"P"},{keyId:"key26"},{keyId:"key27"},{keyId:"key28"}]},{keys:[{keyId:"key29",keySize:4},{keyId:"key30",label:"A"},{keyId:"key31",label:"S"},{keyId:"key32"},{keyId:"key33",label:"F"},{keyId:"key34",label:"G"},{keyId:"key35"},{keyId:"key36",label:"J"},{keyId:"key37",label:"K"},{keyId:"key38",label:"L"},{keyId:"key39"},{keyId:"key40"},{keyId:"key41",keySize:4}]},{keys:[{keyId:"key42",keySize:5},{keyId:"key43"},{keyId:"key44"},{keyId:"key45",label:"C"},{keyId:"key46"},{keyId:"key47"},{keyId:"key48"},{keyId:"key49"},{keyId:"key50",label:"<",label2:","},{keyId:"key51",label:">",label2:"."},{keyId:"key52",label:"?",label2:"/"},{keyId:"key53",keySize:5}]},{keys:[{keyId:"key54"},{keyId:"key55"},{keyId:"key56"},{keyId:"key57",keySize:6},{keyId:"key58",keySize:7},{keyId:"key59",keySize:6},{keyId:"key60"},{keyId:"key61",keySize:8,label:"<"},{keyId:"key62 row5-key-fix",keySize:9},{keyId:"key63",keySize:8},{keyId:"key64",keySize:8,label:">"}]}],nonqwerty:[{keys:[{keyId:"key0",label:"esc",keySize:10}]},{keys:[{keyId:"key1"},{keyId:"key2"},{keyId:"key3"},{keyId:"key4"},{keyId:"key5"},{keyId:"key6"},{keyId:"key7"},{keyId:"key8"},{keyId:"key9"},{keyId:"key10"},{keyId:"key11"},{keyId:"key12"},{keyId:"key13"},{keyId:"key14",keySize:1}]},{keys:[{keyId:"key15",keySize:1},{keyId:"key16"},{keyId:"key17"},{keyId:"key18",label:"E"},{keyId:"key19"},{keyId:"key20",label:"T"},{keyId:"key21"},{keyId:"key22"},{keyId:"key23"},{keyId:"key24"},{keyId:"key25",label:"P"},{keyId:"key26",label:"{",label2:"["},{keyId:"key27",label:"}",label2:"]"},{keyId:"key28 row2-key-fix-bottom"},{keyId:"row2-key-fix"}]},{keys:[{keyId:"key29",keySize:4},{keyId:"key30",label:"A"},{keyId:"key31",label:"S"},{keyId:"key32"},{keyId:"key33",label:"F"},{keyId:"key34",label:"G"},{keyId:"key35"},{keyId:"key36",label:"J"},{keyId:"key37",label:"K"},{keyId:"key38",label:"L"},{keyId:"key39"},{keyId:"key40"},{keyId:"key41"},{keyId:"key42 row3-key-fix-top",keySize:2},{keyId:"row3-key-fix"}]},{keys:[{keyId:"key43",keySize:3},{keyId:"key44"},{keyId:"key45"},{keyId:"key46"},{keyId:"key47",label:"C"},{keyId:"key48"},{keyId:"key49"},{keyId:"key50"},{keyId:"key51"},{keyId:"key52",label:"<",label2:","},{keyId:"key53",label:">",label2:"."},{keyId:"key54",label:"?",label2:"/"},{keyId:"key55",keySize:5}]},{keys:[{keyId:"key56"},{keyId:"key57"},{keyId:"key58"},{keyId:"key59",keySize:6},{keyId:"key60",keySize:7},{keyId:"key61",keySize:6},{keyId:"key62"},{keyId:"key63",keySize:8,label:"<"},{keyId:"key64 row5-key-fix",keySize:9},{keyId:"key65",keySize:8},{keyId:"key66",keySize:8,label:">"}]}]};e.namespace("Views")[this.name]=e.Base.create("keyboard-legend-view",e.FlickrView,[],{initializer:function(n){return this.get("container").html===""&&this.setContainerHTML(e.Balls()),this.layouts=t,this.advanced=!1,this.type="nonqwerty",this},buildContainer:function(){var e=this.templates("keyboard-legend")({type:this.advanced?this.type:"short",rows:this.layouts[this.type]});return this.setContainerHTML(e),this},dialogKeyPressed:function(){e.fire("flickr:photo-page:hideKeyboardLegend")},showAdvanced:function(){this.advanced=!0,this.buildContainer()},activate:function(){var e=this.get("container").one(".show-legend-link"),t=this;return this.attachKeyEvent("down:191",this.dialogKeyPressed.bind(this)),e&&this.registerEventHandler(e.on("click",function(e){e.preventDefault(),t.showAdvanced()})),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-keyboard-legend","keyboard-legend-css","html5-balls"]});
/*
YUI 3.13.0 (build 508226d)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("yui-throttle",function(e,t){
/*! Based on work by Simon Willison: http://gist.github.com/292562 */
;e.throttle=function(t,n){n=n?n:e.config.throttleTime||150;if(n===-1)return function(){t.apply(this,arguments)};var r=e.Lang.now();return function(){var i=e.Lang.now();i-r>n&&(r=i,t.apply(this,arguments))}}},"3.13.0",{requires:["yui-base"]});
YUI.add("hermes-template-photo-well",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){return"is-hidden"}function p(e,t){return"is-video"}function d(e,t){var r="",i,s;r+='\n<div class="feedback-widget">\n	<button class="ui-button ui-button-cta ui-button-transparent"><span>',i=n["if"].call(e,e["opt-out-enabled"],{hash:{},inverse:f.noop,fn:f.program(6,v,t),data:t});if(i||i===0)r+=i;return r+="Feedback</span></button>\n</div>\n\n\n",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-toggle-view"],s):l.call(e,"outlet",e["photo-sidebar-toggle-view"],s)))+"\n",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["photo-title-desc-overlay-view"],s):l.call(e,"outlet",e["photo-title-desc-overlay-view"],s)))+"\n",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["photo-sidebar-actions-view"],s):l.call(e,"outlet",e["photo-sidebar-actions-view"],s)))+"\n",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["attribution-view"],s):l.call(e,"outlet",e["attribution-view"],s)))+"\n",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["people-notes-view"],s):l.call(e,"outlet",e["people-notes-view"],s)))+"\n\n",r}function v(e,t){return"Opt-out &amp; "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression;s+='<a class="navigate-target navigate-prev no-click ',o=n["if"].call(t,t["is-hidden"],{hash:{},inverse:f.noop,fn:f.program(1,h,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t["is-video"],{hash:{},inverse:f.noop,fn:f.program(3,p,i),data:i});if(o||o===0)s+=o;s+='" href="#" data-track="prevPhotoButtonClick" data-action="ad"><span class="hide-text">&larr;</span></a>\n\n<div class="facade-of-protection-neue ',o=n["if"].call(t,t["is-video"],{hash:{},inverse:f.noop,fn:f.program(3,p,i),data:i});if(o||o===0)s+=o;s+='">&nbsp;</div>\n\n',a={hash:{},data:i},s+=c((o=n.outlet||t.outlet,o?o.call(t,t["photo-well-media-view"],a):l.call(t,"outlet",t["photo-well-media-view"],a)))+'\n\n<a class="navigate-target navigate-next no-click ',u=n["if"].call(t,t["is-hidden"],{hash:{},inverse:f.noop,fn:f.program(1,h,i),data:i});if(u||u===0)s+=u;s+=" ",u=n["if"].call(t,t["is-video"],{hash:{},inverse:f.noop,fn:f.program(3,p,i),data:i});if(u||u===0)s+=u;s+='" href="#" data-track="nextPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n\n',u=n.unless.call(t,t["is-ad"],{hash:{},inverse:f.noop,fn:f.program(5,d,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-well-media",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;r+='\n	<div class="restricted-interstitial">\n		<div class="restricted-interstitial-message">\n			<h2>Adult Content</h2>\n			',i=n["if"].call(e,e.isSignedIn,{hash:{},inverse:u.program(4,h,t),fn:u.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n		</div>\n	</div>\n",r}function c(e,t){return'\n				<p>This content is for mature audiences only.<br />User discretion is advised.</p>\n				<p><button class="ui-button"><span>Show Me This Content Type</span></button></p>\n			'}function h(e,t){return'\n				<p>You must be signed in to see this content. <a href="http://www.flickr.com/signin/">Sign in</a></p>\n			'}function p(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.isVideo,{hash:{},inverse:u.program(9,v,t),fn:u.program(7,d,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function d(e,t){var r="",i;return r+='\n		<div class="videoplayer main-photo" style="width:',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+"px; height:",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+'px;"></div>\n	',r}function v(e,t){var r="",i;return r+='\n		<img width="',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+'" height="',(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+'" src="',(i=n.src)?i=i.call(e,{hash:{},data:t}):(i=e.src,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="low-res-photo">\n		<img width="',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+'" height="',(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+'" src="',(i=n.highResSrc)?i=i.call(e,{hash:{},data:t}):(i=e.highResSrc,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="main-photo is-hidden" onload="registerFirstPhoto(this)">\n		<noscript>\n			<img width="',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+'" height="',(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+'" src="',(i=n.highResSrc)?i=i.call(e,{hash:{},data:t}):(i=e.highResSrc,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="main-photo">\n		</noscript>\n	',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;o=n["if"].call(t,t.needsInterstitial,{hash:{},inverse:u.program(6,p,i),fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-media",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-well-media-novideo",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return"\n	<div class='restricted-interstitial'>\n		<div class='restricted-interstitial-message'>\n			<h2>Adult Content</h2>\n			<p>This content is for mature audiences only.<br />User discretion is advised.</p>\n			<p><button class='ui-button'><span>Show Me This Content Type</span></button></p>\n		</div>\n	</div>\n"}function c(e,t){var r="",i;r+='\n	<img onload="registerFirstPhoto(this)" class="main-photo',i=n["if"].call(e,e.isVideo,{hash:{},inverse:u.noop,fn:u.program(4,h,t),data:t});if(i||i===0)r+=i;r+='" width="',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+'" height="',(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+'" src="',(i=n.src)?i=i.call(e,{hash:{},data:t}):(i=e.src,i=typeof i===a?i.apply(e):i),r+=f(i)+'">\n	',i=n["if"].call(e,e.isVideo,{hash:{},inverse:u.noop,fn:u.program(6,p,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){return" is-video"}function p(e,t){return'\n	<span class="video-coming-soon hide-text">!</span>\n	<span class="video-coming-soon-text">Video Support Coming Soon</span>\n	'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;o=n["if"].call(t,t.needsInterstitial,{hash:{},inverse:u.program(3,c,i),fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-media-novideo",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("flickr-video-player",function(e){var t={yepSourceUrl:"http://yep.video.yahoo.com/js/3/videoplayer-min.js?lang={{lang}}",playlistUrl:"http://www.flickr.com/video_playlist.gne",lang:e.config.lang,comscoreC4:"",defaultResolution:"1080p",atlas:{maxBitrate:4e3,domain:"video.yahoo.com"},css:{processing:"processing"},messages:{processing:"This video is being processed"}};e.FlickrVideoPlayer=function(e){this.container=e.container,this.model=e.model,this.appContext=e.appContext,this.currentStream=null,this.appContext.flipper.isFlipped("enable-https-videos")&&(t.yepSourceUrl="https://yep.video.yahoo.com/js/3/videoplayer-min.js?lang={{lang}}")},e.FlickrVideoPlayer.prototype={render:function(){var n,r,i=this;n={playlist:{mediaItems:[]},pageSpaceId:this.appContext.flapp.get("activeView").get("spaceid"),comscoreC4:t.comscoreC4,site:"flickr",lang:t.lang,region:"US",autoplay:!1},this.setCurrentStream(t.defaultResolution,"noop"),n.playlist.mediaItems.push(this.toMediaItem(this.currentStream)),this.player=new e.VideoPlatform.VideoPlayer(n),this.player.render(this.container),r=e.VideoPlatform.API_Events,this.player.on(r.PLAYER_ERROR,function(e){i.appContext.error("[video-player] "+e.type+": "+(e.message||"no message"));if(i.__retry){i.container.one(".yui3-videoplayer-content").removeClass("retrying");return}i.__retry=!0,i.container.one(".yui3-videoplayer-content").addClass("retrying"),i.loadStreams().then(function(){i.setCurrentStream(i.currentStream.resolution),i.play()})}),this.player.on(r.PLAYBACK_ERROR,function(e){i.appContext.error("[video-player] "+e.type+": "+(e.message||"no message"))}),this.player.on(r.PLAYER_RENDERED,function(e){i.renderControls()})},hasHdStream:function(){return this.streams["1080p"]||this.streams["720p"]||this.streams.appletv},isHdStream:function(e){return["1080p","720p","appletv"].indexOf(this.currentStream.resolution)>=0},renderControls:function(){var t,n=this.container.one(".yui3-videoplayer-controls"),r=n.one(".aux"),i=this;this.hasHdStream()&&n.addClass("hashdquality"),this.quality=t=e.Node.create("<div/>"),t.set("textContent","HD"),t.addClass("item").addClass("streamquality").addClass("yui3-videoplayer-transparent"),t.addClass("q"+this.currentStream.resolution),t.on("click",function(e){i.setCurrentStream(i.isHdStream()?"360p":"1080p"),i.play()}),r.appendChild(t)},play:function(){this.player.controls.play()},pause:function(){this.player.controls.pause()},resize:function(e,t){this.container.setStyles({width:e+"px",height:t+"px"})},setCurrentStream:function(e,t){this.currentStream&&this.quality&&this.quality.removeClass("q"+this.currentStream.resolution),this.currentStream=this.getStream(e),this.quality&&this.quality.addClass("q"+this.currentStream.resolution);if(t)return;this.player.playlist.clear(),this.player.playlist.addItem(this.toMediaItem(this.currentStream)),this.player.playlist.setPosition(0)},toMediaItem:function(e){return{streamUrl:e.url,images:this.getThumbnails()}},init:function(){var t,n=this;return t=new e.FlickrPromise({script:this.loadScript(),streams:this.loadStreams(),domLive:this._waitDomLive()}),t.then(function(e){n.render()})},_waitDomLive:function(){var t=this.container.getDOMNode().parentElement;return new e.FlickrPromise(function(e,n){var r=50,i;i=function(){var n=t.parentElement;while(n&&n!==document.body)n=n.parentElement;if(n)return e();if(r--<0)return;setTimeout(i,100)},i()})},getStream:function(e){var t,n,r;t=["1080p","720p","appletv","360p","700","300","100","iphone_wifi","288p"],e&&(r=t.indexOf(e),t=r>0?t.slice(r):t);while(t.length){n=this.streams[t.shift()];if(n)return n}return{}},getThumbnails:function(){var e,t;return t={width:parseInt(this.container.getComputedStyle("width"),10)||800,height:parseInt(this.container.getComputedStyle("height"),10)||600},e=this.model.getSizeToFit(t,{excludeSizes:[]}),{large:e.url,medium:e.url,small:e.url}},loadScript:function(){return new e.FlickrPromise(function(n,r){var i,s;if(e.VideoPlatform){n();return}s=function(){e.use("videoplayer",n)},i=document.createElement("script"),i.onload=s,i.src=t.yepSourceUrl.replace("{{lang}}",t.lang),document.head.appendChild(i)})},loadStreams:function(){var t=this;return new e.FlickrPromise(function(e,n){var r;r={photo_id:t.model.getValue("id"),secret:t.model.getValue("secret")},t.appContext.callAPI("flickr.video.getStreamInfo",r).then(function(n){try{t.streams=n.streams.stream.reduce(function(e,t){var n=t.type+"";return e[n]={resolution:n,url:t.content},e},{})}catch(r){t.streams={}}Object.keys(t.streams).length||t.appContext.error("[video-player] no streams available"),e()},function(e){if(e&&e.code&&e.code.toString()==="1")return t.setProcessing();t.appContext.error("[video-player] error fetching playlist")})})},loadXmlStreams:function(){var n=this;return new e.FlickrPromise(function(r,i){var s,o;s={nsid:n.model.getValue("owner").getValue("nsid"),video_id:n.model.getValue("id"),bitrate:t.atlas.maxBitrate,secret:n.model.getValue("secret"),rd:t.atlas.domain,noad:1},o=new XMLHttpRequest,o.open("GET",e.flutil.buildHttpQuery(t.playlistUrl,s)),o.onload=function(){var e,t,i;e=document.createElement("div"),e.innerHTML=o.responseText,i=e.getElementsByTagName("duration")[0],i=i?parseInt(i.textContent,10):0,t=Array.prototype.slice.call(e.getElementsByTagName("stream")),n.streams=t.reduce(function(e,t){var n=Array.prototype.reduce.call(t.attributes,function(e,t){return e[t.name]=t.value,e},{});return n.url=n.app+n.fullpath,n.resolution=(n.path.match(/_([^\.\_]+)\./)||[])[1],n.duration=i,e[n.resolution]=n,e},{}),Object.keys(n.streams).length||n.appContext.error("[video-player] no streams available"),r()},o.onerror=function(){n.appContext.error('[video-player] error fetching playlist XML "'+e.flutil.buildHttpQuery(t.playlistUrl,s)+'"')},o.send()})},_cleanup:function(e){e=e.getDOMNode();var t=function(e){if(!e.firstChild)return;while(e.firstChild)t(e.firstChild),e.removeChild(e.firstChild)};t(e)},setProcessing:function(){var t=e.Node.create("<img/>");t.set("src",this.getThumbnails
().large),this.container.appendChild(t)},destroy:function(){this.player&&this.player.destroy(),this.player=null,this.quality&&this.quality.detach(),this.quality=null,this._cleanup(this.container),this.container=null,this.model=null,this.appContext=null,this.streams=null}}},"@VERSION@",{requires:["flickr-promise","flutil"],optional:[]});
YUI.add("hermes-template-photo-well-ad",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s,o;return r+='\n    <div class="ad-wrapper">\n        <img width=\'',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+"' height='",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+"' src='",(i=n.src)?i=i.call(e,{hash:{},data:t}):(i=e.src,i=typeof i===a?i.apply(e):i),r+=f(i)+'\'/>\n        <a class="ad-footer" href="',o={hash:{},data:t},r+=f((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.clickUrl,o):l.call(e,"renderTrustedMarkup",e.clickUrl,o)))+'" data-track="ad_link_bottom" style="width:',(s=n.width)?s=s.call(e,{hash:{},data:t}):(s=e.width,s=typeof s===a?s.apply(e):s),r+=f(s)+'px" target="_blank">\n            <h1>Find out more at ',o={hash:{},data:t},r+=f((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.brand,o):l.call(e,"renderTrustedMarkup",e.brand,o)))+"</h1>\n        </a>\n    </div>\n",r}function d(e,t){var r="",i;return r+="\n    <img width='",(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+"' height='",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+"' src='",(i=n.src)?i=i.call(e,{hash:{},data:t}):(i=e.src,i=typeof i===a?i.apply(e):i),r+=f(i)+"' />\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing,c=this,h=n.blockHelperMissing;u={hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i},(o=n.adsTypeB)?o=o.call(t,u):(o=t.adsTypeB,o=typeof o===a?o.apply(t):o),n.adsTypeB||(o=h.call(t,o,u));if(o||o===0)s+=o;s+="\n",u={hash:{},inverse:c.program(3,d,i),fn:c.noop,data:i},(o=n.adsTypeB)?o=o.call(t,u):(o=t.adsTypeB,o=typeof o===a?o.apply(t):o),n.adsTypeB||(o=h.call(t,o,u));if(o||o===0)s+=o;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-ad",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-well-media-view",function(e){var t=500,n=500,r=100,i;i={photo:{render:function(){var t=this,n,i=this.get("photo"),s,o,u=new Date;return t.preloadImage&&(t.preloadImage.onload=null),s=this.getPhotoForDisplay(),o=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]}),n=this.templates("photo-well-media")({width:s.width,height:s.height,src:o.url,highResSrc:s.url,needsInterstitial:i.getValue("needsInterstitial"),isSignedIn:t.appContext.auth.signedIn,isVideo:i.getValue("isVideo")}),this.setContainerHTML(n),YUI.Env.isServer||i.getValue("needsInterstitial")||(t.preloadImage=new Image,t.preloadImage.onload=function(){if(this.onloadFired)return;if(!t.isActiveAndInDOM())return;this.onloadFired=!0;var n=t.get("container").one(".low-res-photo"),i=t.get("container").one(".main-photo"),s=new Date-u,o,a;s<r?(i.removeClass("is-hidden").show(),n.hide()):(o=n.getXY(),i.setStyles({position:"absolute",left:0,top:0,opacity:0}),i.removeClass("is-hidden"),a=function(){i.removeAttribute("style"),n.hide()},e.UA.ie?a():e.use("transition",function(e){i.transition({duration:.25,opacity:1},a)}))},t.preloadImage.src=s.url,t.preloadImage.complete&&t.preloadImage.onload()),this}},video:{render:function(){var t,n=this,r=this.get("photo"),i=this.getPhotoForDisplay({excludeSizes:[]});return this.player?(this.player.resize(i.width,i.height),this):(t=this.templates("photo-well-media")({width:i.width,height:i.height,src:i.url,needsInterstitial:r.getValue("needsInterstitial"),isVideo:r.getValue("isVideo")}),this.setContainerHTML(t),YUI.Env.isServer?this:(this.player=new e.FlickrVideoPlayer({container:this.get("container").one(".videoplayer"),model:r,appContext:this.appContext}),n.player.init().then(function(){n}),this.on("destroy",function(){n.player.destroy(),n.player=null}),this))}},flippedOff:{render:function(){var e,t=this.get("photo"),n=this.getPhotoForDisplay();return e=this.templates("photo-well-media-novideo")({width:n.width,height:n.height,src:n.url,needsInterstitial:t.getValue("needsInterstitial"),isVideo:t.getValue("isVideo")}),this.setContainerHTML(e),this}},ad:{render:function(){var e,t,n;return this.adJSON?t=this.adJSON:(t=this.appContext.adManager.getAdJSON(),this.adJSON=t),n=this.getAdSize(t),e=this.templates("photo-well-ad")({width:n.width,height:n.height,src:t.url,clickUrl:t.clickUrl,brand:t.brand,adsTypeB:this.appContext.flipper.isFlipped("moneyball-ads-type-b")}),this.setContainerHTML(e),this}}},e.namespace("Views")[this.name]=e.Base.create("photo-well-media-view",e.FlickrView,[],{initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.get("container").html===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?i.ad.render.call(this):this.appContext.flipper.isFlipped("yep-video")?i[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this):i.flippedOff.render.call(this),this},handleInterstitialDismissButtonClick:function(e){var t=this,n=this.get("personPreferences"),r=this.get("photo"),i=r.getValue("safetyLevel");n.setValue("safeSearch",i),n.registry.remoteUpdate(t.appContext.auth.user.nsid).then(function(e){var i=r.registry.attributeSearch({needsInterstitial:!0});i.forEach(function(e){r.registry.getValue(e,"safetyLevel")<=n.getValue("safeSearch")&&r.registry.setValue(e,"needsInterstitial",!1)}),t.buildContainer()},function(e){t.appContext.error(e.message),t.appContext.error(e.stack),t.onError("We couldn't update your settings")})},activate:function(){var t=this,n=this.getPhotoForDisplay(),r=this.get("container").one(".main-photo"),i,s;return this.get("photo").getValue("needsInterstitial")||(e.use("global-events",function(e){t.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()}))}),this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),!this.isAd&&(!t.get("clientRendered")||n.width!==Number(r.getAttribute("width"))||n.height!==Number(r.getAttribute("height")))&&t.buildContainer()),this.registerEventHandler(e.on("flickr:display-note-box",function(n){i=e.Node.create('<div class="note-box"></div>'),s=t.get("container").one(".main-photo").getXY(),t.get("container").append(i),i.setStyles({top:n.noteBoxTop+t.get("container").one(".main-photo").getDOMNode().offsetTop,left:n.noteBoxLeft,width:n.noteBoxWidth,height:n.noteBoxHeight})})),t.appContext.auth.signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},onError:function(t){var n=e.Views.dialog.getInstance("dialog-alert",{content:"Error! "+t,attrs:{level:"warning"},parent:this});n.show()},getPhotoForDisplay:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=this.get("photo").getSizeToFit(t,e),i,s;return i=Math.min(t.height/n,r.height),s=Math.min(t.width/n,r.width/r.height*i),i=Math.min(i,r.height/r.width*s),{width:Math.round(s),height:Math.round(i),url:r.url}},getAdSize:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=80,i=140,s,o;return this.appContext.flipper.isFlipped("moneyball-ads-type-b")&&(t.height-=(r+i)*n,t.width-=i*n),s=Math.min(t.height/n,e.height),o=Math.min(t.width/n,e.width/e.height*s),s=Math.min(s,e.height/e.width*o),{width:o,height:s}},getCanvasSize:function(){var e,r=this.getPixelRatio(),i;return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(i=this.get("container").ancestor(),i&&(e=i.get("region"),e.width>0&&e.height>0&&(this.set("canvasSizeIsDirty",!1),this.set("cachedCanvasSize",e),this.appContext.setCookie({remove:!0,cookieName:"photoPW",path:"/photos/"
,cookieValue:e.width}),this.appContext.setCookie({remove:!0,cookieName:"photoPH",path:"/photos/",cookieValue:e.height}),this.appContext.setCookie({remove:!0,cookieName:"density",path:"/photos/",cookieValue:r})))):e=this.get("cachedCanvasSize"),e||(e={top:0,left:0,bottom:n,right:t,width:parseInt(this.appContext.getCookie("photoPW"),10)||t,height:parseInt(this.appContext.getCookie("photoPH"),10)||n}),e.height*=r,e.width*=r,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-well-media","hermes-template-photo-well-media-novideo","moment","flickr-video-player","hermes-template-photo-well-ad"],optional:["photo-models"]});
YUI.add("type-validator",function(e){function r(){var e;for(e in n)(function(){var r=n[e];t[e]=function(e){return r.test(e)}})()}var t={},n={nsid:/([0-9]+@N[0-9]+)/,pathAlias:/([0-9a-zA-Z-_]+)/,photoId:/[0-9]+/,bookId:/[0-9]+/,orderId:/[0-9]+/};r(),e.TypeValidator={matches:t}},"@VERSION@",{requires:["person-models","flickr-promise"]});
YUI.add("hermes-template-photo-sidebar",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=n.helperMissing;return s+='\n\n<a class="newCloseBtn hide-text" href="',(o=n["close-url"])?o=o.call(t,{hash:{},data:i}):(o=t["close-url"],o=typeof o===a?o.apply(t):o),s+=f(o)+'" data-track="sidebarCloseButtonClick">&times;</a>\n<div class="sidebar-panel-fixed">\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["attribution-view"],u):l.call(t,"outlet",t["attribution-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-title-desc-view"],u):l.call(t,"outlet",t["photo-title-desc-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-stats-view"],u):l.call(t,"outlet",t["photo-stats-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["context-slider-view"],u):l.call(t,"outlet",t["context-slider-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["actions-view"],u):l.call(t,"outlet",t["actions-view"],u)))+'\n</div>\n<div class="sidebar-panel-scrollable">\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["comments-view"],u):l.call(t,"outlet",t["comments-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-charms-view"],u):l.call(t,"outlet",t["photo-charms-view"],u)))+"\n</div>\n\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-sidebar",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-attribution",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;return r+='style="background-image: url(',(i=n.buddyicon)?i=i.call(e,{hash:{},data:t}):(i=e.buddyicon,i=typeof i===a?i.apply(e):i),r+=f(i)+');"></a>',r}function p(e,t){var r="",i;return r+='><img src="',(i=n.buddyicon)?i=i.call(e,{hash:{},data:t}):(i=e.buddyicon,i=typeof i===a?i.apply(e):i),r+=f(i)+'" width="55" height="55"></a>',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+='\n<a class="attribution-icon circle-icon" href="/photos/',(o=n.pathAlias)?o=o.call(t,{hash:{},data:i}):(o=t.pathAlias,o=typeof o===a?o.apply(t):o),s+=f(o)+'/" data-track="attributionAvatarClick" ',o=n["if"].call(t,t.realFullscreenEnabled,{hash:{},inverse:l.program(3,p,i),fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;return s+='\n\n<div class="attribution-info">\n	\n	<a href="/photos/',(o=n.pathAlias)?o=o.call(t,{hash:{},data:i}):(o=t.pathAlias,o=typeof o===a?o.apply(t):o),s+=f(o)+'/" class="owner-name truncate" title="Go to ',(o=n.displayname)?o=o.call(t,{hash:{},data:i}):(o=t.displayname,o=typeof o===a?o.apply(t):o),s+=f(o)+'\'s photostream" data-track="attributionNameClick">',(o=n.displayname)?o=o.call(t,{hash:{},data:i}):(o=t.displayname,o=typeof o===a?o.apply(t):o),s+=f(o)+"</a>\n	\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t.follow,u):c.call(t,"outlet",t.follow,u)))+"\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/attribution",function(e){return n(e,{partials:r})})},"@VERSION@",{requires:["template-base","handlebars-base"]});
